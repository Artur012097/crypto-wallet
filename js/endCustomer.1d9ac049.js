(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["endCustomer"],{"02dc":function(e,t,n){"use strict";n("6b3c")},"07ac":function(e,t,n){var a=n("23e7"),c=n("6f53").values;a({target:"Object",stat:!0},{values:function(e){return c(e)}})},3265:function(e,t,n){},3835:function(e,t,n){"use strict";function a(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return l}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function c(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,c,s=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(s.push(a.value),t&&s.length===t)break}catch(r){l=!0,c=r}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw c}}return s}}var s=n("06c5");n("d9e2"),n("d401");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){return a(e)||c(e,t)||Object(s["a"])(e,t)||o()}},"4fad":function(e,t,n){var a=n("23e7"),c=n("6f53").entries;a({target:"Object",stat:!0},{entries:function(e){return c(e)}})},"6b3c":function(e,t,n){},"6f53":function(e,t,n){var a=n("83ab"),c=n("e330"),s=n("df75"),o=n("fc6a"),l=n("d1e7").f,r=c(l),i=c([].push),u=function(e){return function(t){var n,c=o(t),l=s(c),u=l.length,d=0,b=[];while(u>d)n=l[d++],a&&!r(c,n)||i(b,e?[n,c[n]]:c[n]);return b}};e.exports={entries:u(!0),values:u(!1)}},"7db0":function(e,t,n){"use strict";var a=n("23e7"),c=n("b727").find,s=n("44d2"),o="find",l=!0;o in[]&&Array(1)[o]((function(){l=!1})),a({target:"Array",proto:!0,forced:l},{find:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}}),s(o)},a81f:function(e,t,n){"use strict";n("3265")},ed05:function(e,t,n){"use strict";n.r(t);n("b0c0");var a=n("7a23"),c=function(e){return Object(a["w"])("data-v-1f5c0fe4"),e=e(),Object(a["u"])(),e},s={class:"end-customer"},o=c((function(){return Object(a["g"])("h1",{class:"end-customer__title page__title"},"Конечный заказчик",-1)})),l={class:"end-customer-content page-wrapper"},r={class:"end-customer-fields"},i={class:"end-customer-fields-row fields-row"},u={class:"end-customer-fields-row fields-row _inn"},d={class:"end-customer-fields-row fields-row"},b={class:"end-customer-fields-row fields-row _city"},f={class:"end-customer-fields-row fields-row _bio"},j={class:"end-customer-buttons page-buttons _save"},O={class:"end-customer-buttons__send _save__button"},m=Object(a["h"])("Сохранить"),p={class:"end-customer-search page-wrapper"},g={class:"end-customer-search-field"},h={class:"page-wrapper"};function _(e,t,n,c,_,v){var y=Object(a["B"])("base-input"),C=Object(a["B"])("base-button"),w=Object(a["B"])("end-customer-table"),k=Object(a["B"])("base-modal");return Object(a["t"])(),Object(a["f"])(a["a"],null,[Object(a["g"])("section",s,[o,Object(a["g"])("div",l,[Object(a["g"])("div",r,[Object(a["g"])("div",i,[Object(a["i"])(y,{id:"end-customer-customer",label:"Конечный заказчик",required:!0,modelValue:_.data.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return _.data.name=e})},null,8,["modelValue"])]),Object(a["g"])("div",u,[Object(a["i"])(y,{label:"ИНН",id:"end-customer-inn",type:"number",message:_.message,onInput:t[1]||(t[1]=function(e){return _.message=""}),required:!0,modelValue:_.data.inn,"onUpdate:modelValue":t[2]||(t[2]=function(e){return _.data.inn=e})},null,8,["message","modelValue"])]),Object(a["g"])("div",d,[Object(a["i"])(y,{label:"Регион",id:"end-customer-region",required:!0,modelValue:_.data.region,"onUpdate:modelValue":t[3]||(t[3]=function(e){return _.data.region=e})},null,8,["modelValue"])]),Object(a["g"])("div",b,[Object(a["i"])(y,{label:"Город",id:"end-customer-city",required:!0,modelValue:_.data.city,"onUpdate:modelValue":t[4]||(t[4]=function(e){return _.data.city=e})},null,8,["modelValue"])]),Object(a["g"])("div",f,[Object(a["i"])(y,{label:"ФИО заведующего эндоскопии",id:"end-customer",placeholder:"Если есть",labelStyle:{transform:"translateY(10px)"},required:!0,modelValue:_.data.head_of_endoscopy_full_name,"onUpdate:modelValue":t[5]||(t[5]=function(e){return _.data.head_of_endoscopy_full_name=e})},null,8,["labelStyle","modelValue"])])])]),Object(a["g"])("div",j,[Object(a["g"])("div",O,[Object(a["i"])(C,{type:"filled",onClicked:v.addEndCustomer},{default:Object(a["L"])((function(){return[m]})),_:1},8,["onClicked"])])]),Object(a["g"])("div",p,[Object(a["g"])("div",g,[Object(a["i"])(y,{id:"endCustomerSearch",placeholder:e.$isMobile?"Поиск":"Поиск по контрагенту или ИНН",search:!0,searchIcon:!0,suggestionWidth:380,suggestions:_.suggestions,onSetSuggestion:v.getEndCustomers,onKeypressEnter:v.getEndCustomers,onClear:t[6]||(t[6]=function(e){return _.query="",v.getEndCustomers()}),onInput:t[7]||(t[7]=function(e){return v.getEndCustomers("search")}),modelValue:_.query,"onUpdate:modelValue":t[8]||(t[8]=function(e){return _.query=e})},null,8,["placeholder","suggestions","onSetSuggestion","onKeypressEnter","modelValue"])])]),Object(a["g"])("div",h,[Object(a["i"])(w,{endCustomers:_.endCustomers,onEdit:v.editEndCustomer},null,8,["endCustomers","onEdit"])])]),Object(a["i"])(k,{open:_.openModal,text:"Отправлено",onClose:t[9]||(t[9]=function(e){return _.openModal=!1})},null,8,["open"])],64)}var v=n("3835"),y=n("b85c"),C=n("ade3"),w=(n("45fc"),n("d3b7"),n("07ac"),n("99af"),n("c740"),n("4fad"),n("d9e2"),n("d401"),n("7db0"),n("2141")),k=n("30a8"),E=n("4829"),V=function(e){return Object(a["w"])("data-v-ecf38076"),e=e(),Object(a["u"])(),e},F={key:0,class:"end-customer-table"},M=V((function(){return Object(a["g"])("thead",null,[Object(a["g"])("tr",null,[Object(a["g"])("th",null,"Конечный заказчик"),Object(a["g"])("th",{class:"upp"},"Инн"),Object(a["g"])("th",null,"Регион"),Object(a["g"])("th",null,"Город"),Object(a["g"])("th",null,"ФИО заведующего эндоскопии")])],-1)})),q={key:0},I=["onClick"],$={class:"tooltip"},S={class:"tooltip"},A={class:"tooltip"},B={class:"tooltip"},U={class:"tooltip"},x={key:1,class:"end-customer-table-mobile table-mobile",ref:"table"},P=["onClick"],T={key:0,class:"table-mobile-row"},z=V((function(){return Object(a["g"])("span",{class:"end-customer-table-mobile__title table-mobile__title"}," Кон. заказчик ",-1)})),J={class:"table-mobile__value"},K={key:1,class:"table-mobile-row"},L=V((function(){return Object(a["g"])("span",{class:"end-customer-table-mobile__title table-mobile__title upp"}," ИНН ",-1)})),W={class:"table-mobile__value"},Y={key:2,class:"table-mobile-row"},D=V((function(){return Object(a["g"])("span",{class:"end-customer-table-mobile__title table-mobile__title"}," Регион ",-1)})),G={class:"table-mobile__value"},H={key:3,class:"table-mobile-row"},N=V((function(){return Object(a["g"])("span",{class:"end-customer-table-mobile__title table-mobile__title"}," Город ",-1)})),Q={class:"table-mobile__value"},R={key:4,class:"table-mobile-row"},X=V((function(){return Object(a["g"])("span",{class:"end-customer-table-mobile__title table-mobile__title"},[Object(a["g"])("span",{class:"upp"},"фио"),Object(a["h"])(" зав. ")],-1)})),Z={class:"table-mobile__value"};function ee(e,t,n,c,s,o){var l=Object(a["C"])("tooltip");return e.$isMobile?n.endCustomers.length&&e.$isMobile?(Object(a["t"])(),Object(a["f"])("div",x,[(Object(a["t"])(!0),Object(a["f"])(a["a"],null,Object(a["z"])(n.endCustomers,(function(t){return Object(a["t"])(),Object(a["f"])("div",{class:"table-mobile-column",key:t.id,onClick:function(n){return e.$emit("edit",t.id)}},[t.name?(Object(a["t"])(),Object(a["f"])("div",T,[z,Object(a["g"])("span",J,Object(a["F"])(t.name),1)])):Object(a["e"])("",!0),t.inn?(Object(a["t"])(),Object(a["f"])("div",K,[L,Object(a["g"])("span",W,Object(a["F"])(t.inn),1)])):Object(a["e"])("",!0),t.region?(Object(a["t"])(),Object(a["f"])("div",Y,[D,Object(a["g"])("span",G,Object(a["F"])(t.region),1)])):Object(a["e"])("",!0),t.city?(Object(a["t"])(),Object(a["f"])("div",H,[N,Object(a["g"])("span",Q,Object(a["F"])(t.city),1)])):Object(a["e"])("",!0),t.head_of_endoscopy_full_name?(Object(a["t"])(),Object(a["f"])("div",R,[X,Object(a["g"])("span",Z,Object(a["F"])(t.head_of_endoscopy_full_name),1)])):Object(a["e"])("",!0)],8,P)})),128))],512)):Object(a["e"])("",!0):(Object(a["t"])(),Object(a["f"])("table",F,[M,n.endCustomers.length?(Object(a["t"])(),Object(a["f"])("tbody",q,[(Object(a["t"])(!0),Object(a["f"])(a["a"],null,Object(a["z"])(n.endCustomers,(function(t){return Object(a["t"])(),Object(a["f"])("tr",{key:t.id,onClick:function(n){return e.$emit("edit",t.id)}},[Object(a["g"])("td",null,[Object(a["g"])("span",null,Object(a["F"])(t.name),1),Object(a["M"])((Object(a["t"])(),Object(a["f"])("span",$,[Object(a["h"])(Object(a["F"])(t.name),1)])),[[l]])]),Object(a["g"])("td",null,[Object(a["g"])("span",null,Object(a["F"])(t.inn),1),Object(a["M"])((Object(a["t"])(),Object(a["f"])("span",S,[Object(a["h"])(Object(a["F"])(t.inn),1)])),[[l]])]),Object(a["g"])("td",null,[Object(a["g"])("span",null,Object(a["F"])(t.region),1),Object(a["M"])((Object(a["t"])(),Object(a["f"])("span",A,[Object(a["h"])(Object(a["F"])(t.region),1)])),[[l]])]),Object(a["g"])("td",null,[Object(a["g"])("span",null,Object(a["F"])(t.city),1),Object(a["M"])((Object(a["t"])(),Object(a["f"])("span",B,[Object(a["h"])(Object(a["F"])(t.city),1)])),[[l]])]),Object(a["g"])("td",null,[Object(a["g"])("span",null,Object(a["F"])(t.head_of_endoscopy_full_name),1),Object(a["M"])((Object(a["t"])(),Object(a["f"])("span",U,[Object(a["h"])(Object(a["F"])(t.head_of_endoscopy_full_name),1)])),[[l]])])],8,I)})),128))])):Object(a["e"])("",!0)]))}var te={name:"EndCustomersTable",props:{endCustomers:{type:Array}}},ne=(n("02dc"),n("6b0d")),ae=n.n(ne);const ce=ae()(te,[["render",ee],["__scopeId","data-v-ecf38076"]]);var se=ce,oe={name:"EndCustomer",components:{BaseInput:w["a"],BaseButton:k["a"],BaseModal:E["a"],EndCustomerTable:se},computed:{user:function(){return this.$store.state.user}},data:function(){return{data:{name:"",inn:"",region:"",city:"",head_of_endoscopy_full_name:""},message:"",query:"",openModal:!1,edit:!1,id:"",endCustomers:[],suggestions:[]}},mounted:function(){this.getEndCustomers()},methods:{getEndCustomers:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=Object(C["a"])({},this.query&&"search",this.query);this.suggestions=[],this.$api.get("".concat(this.$api.defaults.API,"/end-customer"),{params:n}).then((function(n){console.log(n.data.results),"search"!==t&&(e.endCustomers=[]);var a,c=Object(y["a"])(n.data.results);try{for(c.s();!(a=c.n()).done;){var s=a.value;"search"!==t&&e.endCustomers.push(s),"search"==t&&e.query&&e.suggestions.push({key:s.id,value:s.id})}}catch(o){c.e(o)}finally{c.f()}}))},addEndCustomer:function(){var e=this;Object.values(this.data).some((function(e){return!e}))||(this.edit?this.$api.patch("".concat(this.$api.defaults.API,"/end-customer/").concat(this.id),this.data).then((function(t){var n=e.endCustomers.findIndex((function(e){return e.id==t.data.id}));e.endCustomers[n]=t.data;for(var a=0,c=Object.entries(e.data);a<c.length;a++){var s=Object(v["a"])(c[a],1),o=s[0];e.data[o]=""}e.edit=!1,e.openModal=!0})).catch((function(e){new Error(e)})):this.$api.post("".concat(this.$api.defaults.API,"/end-customer"),this.data).then((function(t){e.endCustomers.push(t.data);for(var n=0,a=Object.entries(e.data);n<a.length;n++){var c=Object(v["a"])(a[n],1),s=c[0];e.data[s]=""}e.openModal=!0})).catch((function(t){t.response.data.inn&&(e.message="Данный ИНН уже существует в нашей базе данных")})))},editEndCustomer:function(e){var t=this.endCustomers.find((function(t){return t.id===e}));this.id=t.id,this.edit=!0;for(var n=0,a=Object.entries(t);n<a.length;n++){var c=Object(v["a"])(a[n],1),s=c[0];this.data[s]=t[s]}}}};n("a81f");const le=ae()(oe,[["render",_],["__scopeId","data-v-1f5c0fe4"]]);t["default"]=le}}]);
//# sourceMappingURL=endCustomer.1d9ac049.js.map