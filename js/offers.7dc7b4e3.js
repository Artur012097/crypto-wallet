(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["offers"],{"07ac":function(e,t,n){var r=n("23e7"),o=n("6f53").values;r({target:"Object",stat:!0},{values:function(e){return o(e)}})},"0cb2":function(e,t,n){var r=n("e330"),o=n("7b0b"),a=Math.floor,c=r("".charAt),i=r("".replace),l=r("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,f){var b=n+e.length,p=r.length,h=u;return void 0!==d&&(d=o(d),h=s),i(f,h,(function(o,i){var s;switch(c(i,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,b);case"<":s=d[l(i,1,-1)];break;default:var u=+i;if(0===u)return o;if(u>p){var f=a(u/10);return 0===f?o:f<=p?void 0===r[f-1]?c(i,1):r[f-1]+c(i,1):o}s=r[u-1]}return void 0===s?"":s}))}},"0d6b":function(e,t,n){"use strict";n.r(t);var r=n("7a23");function o(e,t,n,o,a,c){var i=Object(r["F"])("router-view");return Object(r["x"])(),Object(r["f"])(i)}var a={name:"Offer"},c=n("6b0d"),i=n.n(c);const l=i()(a,[["render",o]]);t["default"]=l},"0e34":function(e,t,n){e.exports=n.p+"img/excel.847a47e8.svg"},1148:function(e,t,n){"use strict";var r=n("da84"),o=n("5926"),a=n("577e"),c=n("1d80"),i=r.RangeError;e.exports=function(e){var t=a(c(this)),n="",r=o(e);if(r<0||r==1/0)throw i("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},1276:function(e,t,n){"use strict";var r=n("2ba4"),o=n("c65b"),a=n("e330"),c=n("d784"),i=n("44e7"),l=n("825a"),s=n("1d80"),u=n("4840"),d=n("8aa5"),f=n("50c4"),b=n("577e"),p=n("dc4a"),h=n("4dae"),O=n("14c3"),j=n("9263"),m=n("9f7f"),v=n("d039"),g=m.UNSUPPORTED_Y,y=4294967295,_=Math.min,k=[].push,C=a(/./.exec),x=a(k),w=a("".slice),$=!v((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));c("split",(function(e,t,n){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var a=b(s(this)),c=void 0===n?y:n>>>0;if(0===c)return[];if(void 0===e)return[a];if(!i(e))return o(t,a,e,c);var l,u,d,f=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),O=0,m=new RegExp(e.source,p+"g");while(l=o(j,m,a)){if(u=m.lastIndex,u>O&&(x(f,w(a,O,l.index)),l.length>1&&l.index<a.length&&r(k,f,h(l,1)),d=l[0].length,O=u,f.length>=c))break;m.lastIndex===l.index&&m.lastIndex++}return O===a.length?!d&&C(m,"")||x(f,""):x(f,w(a,O)),f.length>c?h(f,0,c):f}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:o(t,this,e,n)}:t,[function(t,n){var r=s(this),c=void 0==t?void 0:p(t,e);return c?o(c,t,r,n):o(a,b(r),t,n)},function(e,r){var o=l(this),c=b(e),i=n(a,o,c,r,a!==t);if(i.done)return i.value;var s=u(o,RegExp),p=o.unicode,h=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(g?"g":"y"),j=new s(g?"^(?:"+o.source+")":o,h),m=void 0===r?y:r>>>0;if(0===m)return[];if(0===c.length)return null===O(j,c)?[c]:[];var v=0,k=0,C=[];while(k<c.length){j.lastIndex=g?0:k;var $,V=O(j,g?w(c,k):c);if(null===V||($=_(f(j.lastIndex+(g?k:0)),c.length))===v)k=d(c,k,p);else{if(x(C,w(c,v,k)),C.length===m)return C;for(var P=1;P<=V.length-1;P++)if(x(C,V[P]),C.length===m)return C;k=v=$}}return x(C,w(c,v)),C}]}),!$,g)},"1aea":function(e,t,n){e.exports=n.p+"img/pdf.ad036780.svg"},"1d60":function(e,t,n){e.exports=n.p+"img/filters.393d9f5b.svg"},"1e0b":function(e,t,n){"use strict";n("780b")},"209a":function(e,t,n){e.exports=n.p+"img/ru.9a99cccd.svg"},"417c":function(e,t,n){},"41c7":function(e,t,n){"use strict";n("b6b2")},"4fadc":function(e,t,n){var r=n("23e7"),o=n("6f53").entries;r({target:"Object",stat:!0},{entries:function(e){return o(e)}})},5319:function(e,t,n){"use strict";var r=n("2ba4"),o=n("c65b"),a=n("e330"),c=n("d784"),i=n("d039"),l=n("825a"),s=n("1626"),u=n("5926"),d=n("50c4"),f=n("577e"),b=n("1d80"),p=n("8aa5"),h=n("dc4a"),O=n("0cb2"),j=n("14c3"),m=n("b622"),v=m("replace"),g=Math.max,y=Math.min,_=a([].concat),k=a([].push),C=a("".indexOf),x=a("".slice),w=function(e){return void 0===e?e:String(e)},$=function(){return"$0"==="a".replace(/./,"$0")}(),V=function(){return!!/./[v]&&""===/./[v]("a","$0")}(),P=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));c("replace",(function(e,t,n){var a=V?"$":"$0";return[function(e,n){var r=b(this),a=void 0==e?void 0:h(e,v);return a?o(a,e,r,n):o(t,f(r),e,n)},function(e,o){var c=l(this),i=f(e);if("string"==typeof o&&-1===C(o,a)&&-1===C(o,"$<")){var b=n(t,c,i,o);if(b.done)return b.value}var h=s(o);h||(o=f(o));var m=c.global;if(m){var v=c.unicode;c.lastIndex=0}var $=[];while(1){var V=j(c,i);if(null===V)break;if(k($,V),!m)break;var P=f(V[0]);""===P&&(c.lastIndex=p(i,d(c.lastIndex),v))}for(var I="",T=0,S=0;S<$.length;S++){V=$[S];for(var U=f(V[0]),J=g(y(u(V.index),i.length),0),E=[],M=1;M<V.length;M++)k(E,w(V[M]));var q=V.groups;if(h){var D=_([U],E,J,i);void 0!==q&&k(D,q);var A=f(r(o,void 0,D))}else A=O(U,i,J,E,q,o);J>=T&&(I+=x(i,T,J)+A,T=J+U.length)}return I+x(i,T)}]}),!P||!$||V)},"62e1":function(e,t,n){"use strict";n("d934")},"6f53":function(e,t,n){var r=n("83ab"),o=n("e330"),a=n("df75"),c=n("fc6a"),i=n("d1e7").f,l=o(i),s=o([].push),u=function(e){return function(t){var n,o=c(t),i=a(o),u=i.length,d=0,f=[];while(u>d)n=i[d++],r&&!l(o,n)||s(f,e?[n,o[n]]:o[n]);return f}};e.exports={entries:u(!0),values:u(!1)}},7197:function(e,t,n){"use strict";n.r(t);var r=n("7a23"),o=function(e){return Object(r["A"])("data-v-39af7b72"),e=e(),Object(r["y"])(),e},a={class:"offer-create"},c={class:"offer-create__title page__title"},i=Object(r["j"])(" Коммерческое предложение "),l={key:0},s={key:1,class:"offer-create__title-date"},u={class:"offer-create-wrapper page-wrapper"},d={class:"offer-create-fields fields"},f={class:"offer-create-fields-row fields-row"},b={class:"offer-create-fields-row fields-row"},p={class:"offer-create-fields-row fields-row _area"},h={class:"offer-create-fields-row fields-row"},O={class:"offer-create-fields-row fields-row"},j={class:"offer-create-fields-row fields-row"},m={class:"offer-create-fields-row fields-row _validy"},v={class:"offer-create-fields-row fields-row _area"},g={class:"offer-create-fields-row fields-row"},y={class:"offer-create-products"},_=o((function(){return Object(r["i"])("h2",{class:"offer-create-products__title"},"Продукция",-1)})),k={class:"offer-create-products-row article-row"},C={class:"offer-create-products-field article-row-field"},x={class:"offer-create-products-add article-row-button"},w=Object(r["j"])(" Добавить "),$=o((function(){return Object(r["i"])("h3",{class:"offer-create-company__title"},"Выбрать компанию",-1)})),V={class:"offer-create-company__select"},P={class:"offer-create-type"},I=o((function(){return Object(r["i"])("h4",{class:"offer-create-type__title"},"Сохранить",-1)})),T={class:"offer-create-types"},S={class:"base-check"},U=o((function(){return Object(r["i"])("label",{for:"offerCreatePdf",class:"upp"}," pdf ",-1)})),J={class:"base-check _excel"},E=o((function(){return Object(r["i"])("label",{for:"offerCreateExcel"}," Excel ",-1)})),M={class:"offer-create-type _get-ready"},q=o((function(){return Object(r["i"])("h4",{class:"offer-create-type__title _get-ready"},"Подготовить",-1)})),D={class:"offer-create-types _get-ready"},A={class:"base-check"},F=o((function(){return Object(r["i"])("label",{for:"offerReadyTz",class:"upp"}," тз ",-1)})),Q={class:"base-check upp _ru"},R=o((function(){return Object(r["i"])("label",{for:"offerReadyRu",class:"upp"}," ру ",-1)})),z={key:0,class:"offer-create-tzType"},N=o((function(){return Object(r["i"])("h5",null,"Тип",-1)})),B={class:"base-check radio"},K=o((function(){return Object(r["i"])("label",{for:"offerCreateKtru",class:"upp"}," ктру ",-1)})),L={class:"base-check radio"},G=o((function(){return Object(r["i"])("label",{for:"offerCreateTu",class:"upp"}," ту ",-1)})),H={class:"base-check radio"},W=o((function(){return Object(r["i"])("label",{for:"offerCreateKtrus"},[Object(r["i"])("span",{class:"upp"},"ктру"),Object(r["j"])(" сокр. ")],-1)})),Y={class:"offer-create-actions page-buttons"},X={class:"offer-create__send"},Z=Object(r["j"])(" Отправить "),ee={class:"offer-create__save"},te=Object(r["j"])(" Сохранить "),ne={class:"offer-create__dl"},re=Object(r["j"])(" Скачать ");function oe(e,t,n,o,oe,ae){var ce=Object(r["F"])("base-input"),ie=Object(r["F"])("base-textarea"),le=Object(r["F"])("base-button"),se=Object(r["F"])("offer-create-table"),ue=Object(r["F"])("base-select"),de=Object(r["F"])("base-modal");return Object(r["x"])(),Object(r["h"])(r["b"],null,[Object(r["i"])("section",a,[Object(r["i"])("h1",c,[i,ae.edit&&oe.offer?(Object(r["x"])(),Object(r["h"])("span",l,"№"+Object(r["J"])(oe.offer.id),1)):Object(r["g"])("",!0),ae.edit&&oe.offer?(Object(r["x"])(),Object(r["h"])("span",s,Object(r["J"])(ae.offerDate),1)):Object(r["g"])("",!0)]),Object(r["i"])("div",u,[Object(r["i"])("div",d,[Object(r["i"])("div",f,[Object(r["k"])(ce,{label:"Контрагент",id:"offerCreatecounterparty",suggestions:oe.counterparties,search:!0,onSetSuggestion:ae.getCounterparty,onKeypressEnter:ae.getCounterparty,onInput:ae.getCounterparties,onClear:t[0]||(t[0]=function(e){return oe.data.counterparty="",oe.counterparties=[]}),modelValue:oe.data.counterparty,"onUpdate:modelValue":t[1]||(t[1]=function(e){return oe.data.counterparty=e})},null,8,["suggestions","onSetSuggestion","onKeypressEnter","onInput","modelValue"])]),Object(r["i"])("div",b,[Object(r["k"])(ce,{label:"ИНН",id:"offerCreateInn",disbled:!0,disabled:oe.data.inn&&!0,readonly:oe.data.inn&&!0,modelValue:oe.data.inn,"onUpdate:modelValue":t[2]||(t[2]=function(e){return oe.data.inn=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",p,[Object(r["k"])(ie,{label:"Адрес",id:"offerCreateAddress",disabled:oe.data.address&&!0,readonly:oe.data.address&&!0,modelValue:oe.data.address,"onUpdate:modelValue":t[3]||(t[3]=function(e){return oe.data.address=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",h,[Object(r["k"])(ce,{label:"Телефон",id:"offerCreatePhone",disabled:oe.data.phone&&!0,readonly:oe.data.phone&&!0,modelValue:oe.data.phone,"onUpdate:modelValue":t[4]||(t[4]=function(e){return oe.data.phone=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",O,[Object(r["k"])(ce,{label:"Электронная почта",id:"offerCreateEmail",disabled:oe.data.email&&!0,readonly:oe.data.email&&!0,modelValue:oe.data.email,"onUpdate:modelValue":t[5]||(t[5]=function(e){return oe.data.email=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",j,[Object(r["k"])(ce,{label:"Контактное лицо",id:"offerCreateContact",disabled:oe.data.contactPerson&&!0,readonly:oe.data.contactPerson&&!0,modelValue:oe.data.contactPerson,"onUpdate:modelValue":t[6]||(t[6]=function(e){return oe.data.contactPerson=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",m,[Object(r["k"])(ce,{label:"Срок действия",short:!0,id:"offerCreateValidy",disabled:oe.data.validy&&!0,readonly:oe.data.validy&&!0,modelValue:oe.data.validy,"onUpdate:modelValue":t[7]||(t[7]=function(e){return oe.data.validy=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",v,[Object(r["k"])(ce,{label:"Конечный заказчик",id:"offerCreateEndCustomer",suggestions:oe.customers,search:!0,onSetSuggestion:ae.setCustomer,onKeypressEnter:ae.setCustomer,onInput:ae.getEndCustomer,onClear:t[8]||(t[8]=function(e){return oe.data.endCustomer="",oe.customers=[]}),modelValue:oe.data.endCustomer,"onUpdate:modelValue":t[9]||(t[9]=function(e){return oe.data.endCustomer=e})},null,8,["suggestions","onSetSuggestion","onKeypressEnter","onInput","modelValue"])]),Object(r["i"])("div",g,[Object(r["k"])(ce,{label:"Регион",id:"offerCreateRegion",disabled:oe.data.region&&!0,readonly:oe.data.region&&!0,modelValue:oe.data.region,"onUpdate:modelValue":t[10]||(t[10]=function(e){return oe.data.region=e})},null,8,["disabled","readonly","modelValue"])])]),Object(r["i"])("div",y,[_,Object(r["i"])("div",k,[Object(r["i"])("div",C,[Object(r["k"])(ce,{id:"offerCreatecounterpartyProduct",placeholder:"Артикул или наименование",search:!0,suggestions:oe.productSuggestions,onSetSuggestion:ae.getProducts,onKeypressEnter:ae.getProducts,onInput:t[11]||(t[11]=function(e){return ae.getProducts("search")}),onClear:t[12]||(t[12]=function(e){return oe.productsSearch="",oe.productSuggestions=[]}),modelValue:oe.productsSearch,"onUpdate:modelValue":t[13]||(t[13]=function(e){return oe.productsSearch=e})},null,8,["suggestions","onSetSuggestion","onKeypressEnter","modelValue"])]),Object(r["i"])("div",x,[Object(r["k"])(le,{type:"outlined",onClicked:ae.addProduct},{default:Object(r["P"])((function(){return[w]})),_:1},8,["onClicked"])])]),Object(r["k"])(se,{products:oe.products,onEditProduct:ae.editProduct,onRemoveProduct:ae.removeProduct},null,8,["products","onEditProduct","onRemoveProduct"])]),Object(r["i"])("div",{class:Object(r["s"])(["offer-create-company",{filled:oe.products.length}])},[$,Object(r["i"])("div",V,[Object(r["k"])(ue,{options:oe.companies,modelValue:oe.data.company,"onUpdate:modelValue":t[14]||(t[14]=function(e){return oe.data.company=e}),borderOnly:!0},null,8,["options","modelValue"])])],2),Object(r["i"])("div",P,[I,Object(r["i"])("div",T,[Object(r["i"])("div",S,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreatePdf",value:"pdf","onUpdate:modelValue":t[15]||(t[15]=function(e){return oe.data.tech_docs_format=e})},null,512),[[r["M"],oe.data.tech_docs_format]]),U]),Object(r["i"])("div",J,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateExcel",value:"excel","onUpdate:modelValue":t[16]||(t[16]=function(e){return oe.data.tech_docs_format=e})},null,512),[[r["M"],oe.data.tech_docs_format]]),E])])]),Object(r["i"])("div",M,[q,Object(r["i"])("div",D,[Object(r["i"])("div",A,[Object(r["Q"])(Object(r["i"])("input",{type:"checkbox",id:"offerReadyTz","onUpdate:modelValue":t[17]||(t[17]=function(e){return oe.data.tz=e})},null,512),[[r["L"],oe.data.tz]]),F]),Object(r["i"])("div",Q,[Object(r["Q"])(Object(r["i"])("input",{type:"checkbox",id:"offerReadyRu","onUpdate:modelValue":t[18]||(t[18]=function(e){return oe.data.ru=e})},null,512),[[r["L"],oe.data.ru]]),R])]),oe.data.tz?(Object(r["x"])(),Object(r["h"])("div",z,[N,Object(r["i"])("div",null,[Object(r["i"])("div",B,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateKtru",value:"ktru","onUpdate:modelValue":t[19]||(t[19]=function(e){return oe.data.tzType=e})},null,512),[[r["M"],oe.data.tzType]]),K]),Object(r["i"])("div",L,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateTu",value:"tu","onUpdate:modelValue":t[20]||(t[20]=function(e){return oe.data.tzType=e})},null,512),[[r["M"],oe.data.tzType]]),G]),Object(r["i"])("div",H,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateKtrus",value:"ktrus","onUpdate:modelValue":t[21]||(t[21]=function(e){return oe.data.tzType=e})},null,512),[[r["M"],oe.data.tzType]]),W])])])):Object(r["g"])("",!0)])]),Object(r["i"])("div",Y,[Object(r["i"])("div",X,[Object(r["k"])(le,{type:"filled",onClicked:ae.sendToEmail},{default:Object(r["P"])((function(){return[Z]})),_:1},8,["onClicked"])]),Object(r["i"])("div",ee,[Object(r["k"])(le,{type:"outlined",onClicked:ae.saveOffer},{default:Object(r["P"])((function(){return[te]})),_:1},8,["onClicked"])]),Object(r["i"])("div",ne,[Object(r["k"])(le,{type:"outlined"},{default:Object(r["P"])((function(){return[re]})),_:1})])])]),Object(r["k"])(de,{open:oe.openModal,text:oe.modalText,onClose:t[22]||(t[22]=function(e){return oe.openModal=!1})},null,8,["open","text"])],64)}var ae=n("3835"),ce=n("ade3"),ie=n("b85c"),le=(n("99af"),n("b0c0"),n("45fc"),n("d3b7"),n("c740"),n("a434"),n("d9e2"),n("d401"),n("4fadc"),n("213a")),se=["for"],ue=["id","name","required","disabled","readonly","placeholder","value","minLength","maxlength"],de={key:1,class:"based-textarea__msg"};function fe(e,t,n,o,a,c){return Object(r["x"])(),Object(r["h"])("div",{class:Object(r["s"])(["based-textarea",{"based-textarea-error":n.message,"based-textarea-row":n.label}])},[n.label?(Object(r["x"])(),Object(r["h"])("label",{key:0,for:n.id},Object(r["J"])(n.label),9,se)):Object(r["g"])("",!0),Object(r["i"])("textarea",{ref:"textarea",class:Object(r["s"])({error:n.error}),id:n.id,name:n.id,required:n.required,disabled:n.disabled,readonly:n.readonly,placeholder:n.placeholder,value:n.modelValue,minLength:n.minLength?n.minLength:"",maxlength:n.maxLength?n.maxLength:"",onInput:t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t.target.value),e.$emit("input")}),onFocus:t[1]||(t[1]=function(t){return e.$emit("focus")}),onBlur:t[2]||(t[2]=function(t){return e.$emit("blur")}),onClick:t[3]||(t[3]=function(t){return e.$emit("click")}),onKeypress:[t[4]||(t[4]=Object(r["R"])((function(t){return e.$emit("keypressEnter")}),["enter"])),t[5]||(t[5]=function(t){return e.$emit("keypress")})]},null,42,ue),n.error?(Object(r["x"])(),Object(r["h"])("span",de,Object(r["J"])(n.message),1)):Object(r["g"])("",!0)],2)}n("a9e3");var be={name:"BaseTextarea",props:{id:{type:String},label:{type:String,default:""},error:{type:Boolean,default:!1},required:{type:Boolean},message:{type:String,default:""},placeholder:{type:String,default:""},modelValue:{type:[String,Number],required:!0},minLength:{type:Number},maxLength:{type:Number},disabled:{type:Boolean},readonly:{type:Boolean}},methods:{},emits:["update:modelValue","clear","input","focus","blur","click","keypressEnter","keypress"]},pe=(n("f26d"),n("6b0d")),he=n.n(pe);const Oe=he()(be,[["render",fe],["__scopeId","data-v-10dfe7a2"]]);var je=Oe,me=n("be12"),ve=n("c8de"),ge=n.n(ve),ye=function(e){return Object(r["A"])("data-v-10997c8c"),e=e(),Object(r["y"])(),e},_e={key:0,class:"offer-create-table"},ke=ye((function(){return Object(r["i"])("thead",null,[Object(r["i"])("tr",null,[Object(r["i"])("th",null,"Артикул"),Object(r["i"])("th",null,"Наименование"),Object(r["i"])("th",null,"Цена"),Object(r["i"])("th",null,"Кол-во"),Object(r["i"])("th",null,"Скидка"),Object(r["i"])("th",null,"Стоимость"),Object(r["i"])("th")])],-1)})),Ce={key:0},xe={class:"tooltip"},we={class:"tooltip"},$e={class:"no-wrap"},Ve={class:"no-wrap"},Pe={class:"no-wrap"},Ie={class:"tooltip"},Te={class:"no-wrap"},Se=["onClick"],Ue=ye((function(){return Object(r["i"])("img",{src:ge.a,alt:"Remove"},null,-1)})),Je=[Ue],Ee={key:1,class:"offer-create-table-mobile table-mobile",ref:"table"},Me=["onClick"],qe=ye((function(){return Object(r["i"])("img",{src:ge.a,alt:"Remove"},null,-1)})),De=[qe],Ae={class:"table-mobile-row"},Fe=ye((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Артикул ",-1)})),Qe={class:"table-mobile__value"},Re={class:"table-mobile-row"},ze=ye((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Наим-ие ",-1)})),Ne={class:"table-mobile__value"},Be={class:"table-mobile-row"},Ke=ye((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Цена ",-1)})),Le={class:"table-mobile__value"},Ge={class:"table-mobile-row"},He=ye((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Кол-во ",-1)})),We={class:"table-mobile__value"},Ye={class:"table-mobile-row"},Xe=ye((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Скидка ",-1)})),Ze={class:"table-mobile__value"},et={class:"table-mobile-row"},tt=ye((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Стоимость ",-1)})),nt={class:"table-mobile__value"},rt={key:2,class:"offer-create-price"},ot={class:"offer-create-price__discount"},at=ye((function(){return Object(r["i"])("span",null," Скидка ",-1)})),ct={class:"offer-create-price__total"},it=ye((function(){return Object(r["i"])("span",null," Общая стоимость ",-1)}));function lt(e,t,n,o,a,c){var i=Object(r["F"])("base-input"),l=Object(r["G"])("tooltip");return Object(r["x"])(),Object(r["h"])(r["b"],null,[e.$isMobile?n.products.length&&e.$isMobile?(Object(r["x"])(),Object(r["h"])("div",Ee,[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.products,(function(t,n){return Object(r["x"])(),Object(r["h"])("div",{class:"table-mobile-column",key:n},[Object(r["i"])("span",{class:"_remove",onClick:function(){e.$emit("removeProduct",t.id)}},De,8,Me),Object(r["i"])("div",Ae,[Fe,Object(r["i"])("span",Qe,Object(r["J"])(t.article),1)]),Object(r["i"])("div",Re,[ze,Object(r["i"])("span",Ne,Object(r["J"])(t.name),1)]),Object(r["i"])("div",Be,[Ke,Object(r["i"])("span",Le,[Object(r["k"])(i,{type:"text",tableInput:!0,symbol:"₽",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.price,"onUpdate:modelValue":function(e){return t.price=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])])]),Object(r["i"])("div",Ge,[He,Object(r["i"])("span",We,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"шт",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.count,"onUpdate:modelValue":function(e){return t.count=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])])]),Object(r["i"])("div",Ye,[Xe,Object(r["i"])("span",Ze,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"%",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.discount,"onUpdate:modelValue":function(e){return t.discount=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])])]),Object(r["i"])("div",et,[tt,Object(r["i"])("span",nt,Object(r["J"])(t.cost)+" ₽ ",1)])])})),128))],512)):Object(r["g"])("",!0):(Object(r["x"])(),Object(r["h"])("table",_e,[ke,n.products.length?(Object(r["x"])(),Object(r["h"])("tbody",Ce,[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.products,(function(t,n){return Object(r["x"])(),Object(r["h"])("tr",{key:n},[Object(r["i"])("td",null,[Object(r["i"])("span",null,Object(r["J"])(t.article),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",xe,[Object(r["j"])(Object(r["J"])(t.article),1)])),[[l]])]),Object(r["i"])("td",null,[Object(r["i"])("span",null,Object(r["J"])(t.name),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",we,[Object(r["j"])(Object(r["J"])(t.name),1)])),[[l]])]),Object(r["i"])("td",$e,[Object(r["k"])(i,{type:"text",tableInput:!0,symbol:"₽",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.price,"onUpdate:modelValue":function(e){return t.price=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])]),Object(r["i"])("td",Ve,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"шт",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.count,"onUpdate:modelValue":function(e){return t.count=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])]),Object(r["i"])("td",Pe,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"%",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.discount,"onUpdate:modelValue":function(e){return t.discount=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])]),Object(r["i"])("td",null,[Object(r["i"])("span",null,Object(r["J"])(t.cost)+" ₽ ",1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",Ie,[Object(r["j"])(Object(r["J"])(t.cost)+" ₽ ",1)])),[[l]])]),Object(r["i"])("td",Te,[Object(r["i"])("span",{class:"_remove",onClick:function(){e.$emit("removeProduct",t.id)}},Je,8,Se)])])})),128))])):Object(r["g"])("",!0)])),n.products.length?(Object(r["x"])(),Object(r["h"])("div",rt,[Object(r["i"])("div",null,[Object(r["i"])("div",ot,[at,Object(r["i"])("span",null,Object(r["J"])(c.validateNumberString(c.totalDiscountedPrice))+",00 ₽ ",1)]),Object(r["i"])("div",ct,[it,Object(r["i"])("span",null,Object(r["J"])(c.validateNumberString(c.totalPrice-c.totalDiscountedPrice))+",00 ₽ ",1)])])])):Object(r["g"])("",!0)],64)}n("4160"),n("159b"),n("25f0"),n("ac1f"),n("5319"),n("13d5"),n("1276"),n("b680");var st=function(e){return+e.toString().replace(/\D/g,"")},ut=function(e){return e.toFixed(0).toString().split("").reduce((function(t,n,r){return t+n+(r!==e.length-1&&r%3===2?" ":"")}),"")},dt={name:"OfferCreateTable",props:{products:{type:Array}},methods:{validateNumberString:ut},computed:{totalDiscountedPrice:function(){var e=0;return this.products.forEach((function(t){return e+=st(t.cost)*st(t.discount)/100})),e},totalPrice:function(){var e=0;return this.products.forEach((function(t){return e+=st(t.cost)})),e.toString()}},emits:["removeProduct","editProduct"]};n("62e1");const ft=he()(dt,[["render",lt],["__scopeId","data-v-10997c8c"]]);var bt=ft,pt={components:{BaseTextarea:je,BaseSelect:me["a"],OfferCreateTable:bt},computed:{offerDate:function(){var e=new Date(this.offer.created_at),t=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.toLocaleString("ru",{month:"long"}),r=e.getFullYear();return"".concat(t," ").concat(n," ").concat(r)},edit:function(){return!!this.$route.query.id}},data:function(){return{offer:null,data:{counterparty:"",inn:"",address:"",phone:"",email:"",contactPerson:"",validy:"",endCustomer:"",region:"",tech_docs_format:"",tz:!1,ru:!1,tzType:"",ready:""},openModal:!1,modalText:"Отправлено",products:[],productsSearch:"",companies:[{key:"Не Выбран",value:""}],company:"",counterparties:[],productSuggestions:[],currentCounterparty:{},customers:[],currentCustomer:{},currentProduct:""}},setup:function(){Object(le["b"])({title:"Страница Коммерческого предложения"})},mounted:function(){this.edit&&this.getOffer(),this.getCompanies()},methods:{getCompanies:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/company")).then((function(t){var n,r=Object(ie["a"])(t.data.results);try{var o=function(){var t=n.value,r={key:t.name,value:t.id};!e.companies.some((function(e){return e.value==r.value}))&&r.key&&e.companies.push(r)};for(r.s();!(n=r.n()).done;)o()}catch(a){r.e(a)}finally{r.f()}}))},getOffer:function(){var e=this;this.$store.dispatch("loading",!0),this.$api.get("".concat(this.$api.defaults.API,"/offer/").concat(this.$route.query.id)).then((function(t){console.log(t.data),e.offer=t.data,e.currentCounterparty=e.offer.counterparty||"",e.setCounterparty(),e.data.endCustomer=e.offer.end_customer&&e.offer.end_customer.name||"",e.data.region=e.offer.end_customer&&e.offer.end_customer.region||"",e.currentCustomer=e.offer.end_customer,e.products=e.offer.offer_products||"",e.data.company=t.data.company.id||"",e.data.tech_docs_format=e.offer.tech_docs_format,e.$store.dispatch("loading",!1)}))},getProducts:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=Object(ce["a"])({},this.productsSearch&&"search",this.productsSearch);this.$api.get("".concat(this.$api.defaults.API,"/product"),{params:n}).then((function(n){e.productSuggestions=[];var r,o=Object(ie["a"])(n.data.results);try{for(o.s();!(r=o.n()).done;){var a=r.value;"search"!==t&&e.getProduct(),"search"==t&&e.productsSearch&&e.productSuggestions.push({key:a.name,value:a.id})}}catch(c){o.e(c)}finally{o.f()}}))},getProduct:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/product/").concat(this.productsSearch)).then((function(t){console.log(t.data);var n={product:t.data.id,price:"".concat(t.data.price),discount:e.offer.counterparty.discount,count:1,cost:"".concat(t.data.price)};e.currentProduct=n}))},setCustomer:function(){var e=this;this.data.endCustomer&&this.$api.get("".concat(this.$api.defaults.API,"/end-customer/").concat(this.data.endCustomer)).then((function(t){e.currentCustomer=t.data,e.data.endCustomer=e.currentCustomer.name||"",e.data.region=e.currentCustomer.region||""}))},addProduct:function(){var e=this;this.$store.dispatch("loading",!0),this.$api.post("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/product"),this.currentProduct).then((function(t){console.log(t.data),e.products.push(t.data),e.$store.dispatch("loading",!1)}))},editProduct:function(e){var t=this,n=this.products.findIndex((function(t){return t.id===e})),r={product:this.products[n].product,price:this.products[n].price,discount:this.products[n].discount,count:this.products[n].count,cost:this.products[n].cost};this.$api.patch("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/product/").concat(e),r).then((function(e){t.products[n]=e.data}))},removeProduct:function(e){var t=this;this.$api.delete("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/product/").concat(e)).then((function(){var n=t.products.findIndex((function(t){return t.id==e}));t.products.splice(n,1)}))},getCounterparties:function(){var e=this,t=Object(ce["a"])({},this.data.counterparty&&"search",this.data.counterparty);this.counterparties=[],this.$api.get("".concat(this.$api.defaults.API,"/counterparty"),{params:t}).then((function(t){var n,r=Object(ie["a"])(t.data.results);try{var o=function(){var t=n.value,r={key:t.name||"",value:t.id||""};!e.counterparties.some((function(e){return e.value===r.value}))&&r.key&&e.counterparties.push(r)};for(r.s();!(n=r.n()).done;)o()}catch(a){r.e(a)}finally{r.f()}}))},getCounterparty:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/counterparty/").concat(this.data.counterparty)).then((function(t){e.currentCounterparty=t.data,e.setCounterparty()}))},setCounterparty:function(){this.data.counterparty=this.currentCounterparty.name||"",this.data.inn=this.currentCounterparty.inn||"",this.data.address="".concat(this.currentCounterparty.address_street&&this.currentCounterparty.address_street+","," ").concat(this.currentCounterparty.address_city&&this.currentCounterparty.address_city+","," ").concat(this.currentCounterparty.address_country&&this.currentCounterparty.address_country+","," ").concat(this.currentCounterparty.address_index&&this.currentCounterparty.address_index),this.data.phone="+".concat(this.currentCounterparty.phone_number),this.data.email=this.currentCounterparty.email,this.data.contactPerson=this.currentCounterparty.contact_person||""},getEndCustomer:function(){var e=this,t=Object(ce["a"])({},this.data.endCustomer&&"search",this.data.endCustomer);this.customers=[],this.$api.get("".concat(this.$api.defaults.API,"/end-customer"),{params:t}).then((function(t){console.log(t.data);var n,r=Object(ie["a"])(t.data.results);try{var o=function(){var t=n.value,r={key:t.name||"",value:t.id||""};!e.customers.some((function(e){return e.value===r.value}))&&r.key&&e.customers.push(r)};for(r.s();!(n=r.n()).done;)o()}catch(a){r.e(a)}finally{r.f()}}))},sendToEmail:function(){var e=this;this.$store.dispatch("loading",!0);var t={send_to:this.data.email,co_format:this.data.tzType,required_tech_docs:this.data.tz,tech_docs_format:this.data.tech_docs_format,required_ru:this.data.ru};this.$api.post("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/send-to-email"),t).then((function(){e.$store.dispatch("loading",!1),e.modalText="Отправлено",e.openModal=!0})).catch((function(t){new Error(t),e.$store.dispatch("loading",!1)}))},saveOffer:function(){var e=this;this.$store.dispatch("loading",!0);var t=[];if(this.edit&&this.products){var n,r=Object(ie["a"])(this.products);try{for(r.s();!(n=r.n()).done;){var o=n.value;t.push({product:o.product,price:o.price,discount:o.discount,count:o.count,cost:o.cost})}}catch(c){r.e(c)}finally{r.f()}}console.log(t);var a={counterparty:this.currentCounterparty&&this.currentCounterparty.id||null,end_customer:this.currentCustomer&&this.currentCustomer.id||null,company:this.data.company||null,offer_products:t||null,tech_docs_format:this.data.tech_docs_format};console.log(a),this.edit?this.$api.patch("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id),a).then((function(){e.$store.dispatch("loading",!1),e.modalText="Сохранено",e.openModal=!0})).catch((function(t){new Error(t),e.$store.dispatch("loading",!1)})):this.$api.post("".concat(this.$api.defaults.API,"/offer"),a).then((function(){for(var t=0,n=Object.entries(e.data);t<n.length;t++){var r=Object(ae["a"])(n[t],1),o=r[0];e.data[o]=""}e.$store.dispatch("loading",!1),e.modalText="Сохранено",e.openModal=!0}))}},beforeUnmount:function(){this.offer=null,this.products=[]}};n("edf2");const ht=he()(pt,[["render",oe],["__scopeId","data-v-39af7b72"]]);t["default"]=ht},"780b":function(e,t,n){},"7db0":function(e,t,n){"use strict";var r=n("23e7"),o=n("b727").find,a=n("44d2"),c="find",i=!0;c in[]&&Array(1)[c]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a(c)},"82cc":function(e,t,n){"use strict";n("b771")},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"8dbe":function(e,t,n){e.exports=n.p+"img/tz.3a9a68e5.svg"},"9c58":function(e,t,n){},b680:function(e,t,n){"use strict";var r=n("23e7"),o=n("da84"),a=n("e330"),c=n("5926"),i=n("408a"),l=n("1148"),s=n("d039"),u=o.RangeError,d=o.String,f=Math.floor,b=a(l),p=a("".slice),h=a(1..toFixed),O=function(e,t,n){return 0===t?n:t%2===1?O(e,t-1,n*e):O(e*e,t/2,n)},j=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},m=function(e,t,n){var r=-1,o=n;while(++r<6)o+=t*e[r],e[r]=o%1e7,o=f(o/1e7)},v=function(e,t){var n=6,r=0;while(--n>=0)r+=e[n],e[n]=f(r/t),r=r%t*1e7},g=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var r=d(e[t]);n=""===n?r:n+b("0",7-r.length)+r}return n},y=s((function(){return"0.000"!==h(8e-5,3)||"1"!==h(.9,0)||"1.25"!==h(1.255,2)||"1000000000000000128"!==h(0xde0b6b3a7640080,0)}))||!s((function(){h({})}));r({target:"Number",proto:!0,forced:y},{toFixed:function(e){var t,n,r,o,a=i(this),l=c(e),s=[0,0,0,0,0,0],f="",h="0";if(l<0||l>20)throw u("Incorrect fraction digits");if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return d(a);if(a<0&&(f="-",a=-a),a>1e-21)if(t=j(a*O(2,69,1))-69,n=t<0?a*O(2,-t,1):a/O(2,t,1),n*=4503599627370496,t=52-t,t>0){m(s,0,n),r=l;while(r>=7)m(s,1e7,0),r-=7;m(s,O(10,r,1),0),r=t-1;while(r>=23)v(s,1<<23),r-=23;v(s,1<<r),m(s,1,1),v(s,2),h=g(s)}else m(s,0,n),m(s,1<<-t,0),h=g(s)+b("0",l);return l>0?(o=h.length,h=f+(o<=l?"0."+b("0",l-o)+h:p(h,0,o-l)+"."+p(h,o-l))):h=f+h,h}})},b6b2:function(e,t,n){},b771:function(e,t,n){},be12:function(e,t,n){"use strict";n("99af");var r=n("7a23"),o={key:0},a={key:1,class:"selected ellipse"},c=["onClick"];function i(e,t,n,i,l,s){var u=Object(r["G"])("click-outside");return Object(r["Q"])((Object(r["x"])(),Object(r["h"])("div",{class:Object(r["s"])(["base-select",{"base-select-border":n.borderOnly}]),ref:"select"},[Object(r["i"])("div",{class:Object(r["s"])(["base-select-selected",[{open:l.open,disabled:n.disabled},{"base-select-selected-border":n.borderOnly,active:n.modelValue&&""!==n.modelValue}]]),onClick:t[0]||(t[0]=function(){return s.openDropdown&&s.openDropdown.apply(s,arguments)})},[!n.modelValue||""==n.modelValue&&n.placeholder?(Object(r["x"])(),Object(r["h"])("span",o,Object(r["J"])(n.placeholder),1)):(Object(r["x"])(),Object(r["h"])("span",a,Object(r["J"])(s.selected&&s.selected.key),1))],2),!n.disabled&&l.open?(Object(r["x"])(),Object(r["h"])("div",{key:0,class:Object(r["s"])(["base-select-items",{"base-select-items-border":n.borderOnly}]),ref:"dropdown",style:Object(r["t"])(l.dropdownDirection)},[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.options,(function(t,o){return Object(r["x"])(),Object(r["h"])("div",{key:"".concat(t.value,"_").concat(o),class:Object(r["s"])({active:n.modelValue==t.value}),onClick:function(n){s.selected=t,l.open=!1,e.$emit("update:modelValue",t.value),e.$emit("change")}},Object(r["J"])(t.key),11,c)})),128))],6)):Object(r["g"])("",!0)],2)),[[u,s.closeDropdown]])}n("a9e3"),n("7db0"),n("d3b7");var l={props:{options:{type:Array,required:!0},label:{type:String,default:""},placeholder:{type:[Number,String],default:""},disabled:{type:Boolean},borderOnly:{type:Boolean},modelValue:{type:[String,Number]},yellowBg:{type:Boolean}},computed:{selected:function(){var e=this;return this.options.find((function(t){return t.value===e.modelValue}))||""}},data:function(){return{open:!1,dropdownDirection:null}},methods:{openDropdown:function(){var e=this;this.disabled||(this.open=!this.open),this.open&&setTimeout((function(){var t=e.$refs.select.getBoundingClientRect().top,n=e.$refs.dropdown.getBoundingClientRect().height;window.innerHeight-t<n+60?e.dropdownDirection="top: auto; bottom: ".concat(e.borderOnly?23:40,"px"):e.dropdownDirection="top: ".concat(e.borderOnly?23:40,"px")}))},closeDropdown:function(){this.open=!1}},emits:["update:modelValue","change"]},s=(n("1e0b"),n("6b0d")),u=n.n(s);const d=u()(l,[["render",i],["__scopeId","data-v-ce2f6a6e"]]);t["a"]=d},d934:function(e,t,n){},da3f:function(e,t,n){"use strict";n.r(t);n("45fc"),n("d3b7"),n("07ac"),n("4de4");var r=n("7a23"),o=n("1d60"),a=n.n(o),c=n("c8de"),i=n.n(c),l=function(e){return Object(r["A"])("data-v-a22f56ba"),e=e(),Object(r["y"])(),e},s={class:"offer"},u=l((function(){return Object(r["i"])("h1",{class:"offer__title page__title"},"Коммерческое предложение",-1)})),d={class:"offer-header__buttons"},f={class:"offer_create"},b=Object(r["j"])(" Создать "),p=l((function(){return Object(r["i"])("span",{class:"upp",style:{"margin-left":"2px"}}," кп",-1)})),h={class:"offer_copy"},O=Object(r["j"])(" Копировать "),j={class:"offer-search"},m={key:0,class:"offer-filters__button"},v={key:0,class:"offer-filters__count"},g=l((function(){return Object(r["i"])("img",{src:a.a,alt:"Filters"},null,-1)})),y={key:0,class:"offer-filters__close"},_={key:1,class:"offer-filters__title page__title"},k={class:"offer-filters_counterparty"},C={class:"offer-filters_region"},x={class:"offer-filters_customer"},w={class:"offer-filters_manager"},$={key:2,class:"offer-filters__apply page-buttons"},V={class:"offer-filters__apply-button"},P=Object(r["j"])(" Применить "),I={class:"offer-content page-wrapper"};function T(e,t,n,o,a,c){var l=Object(r["F"])("base-button"),T=Object(r["F"])("base-input"),S=Object(r["F"])("base-select"),U=Object(r["F"])("offers-table");return Object(r["x"])(),Object(r["h"])("section",s,[u,Object(r["i"])("div",{class:Object(r["s"])(["offer-header page-wrapper",{shadow:a.scrollStart}])},[Object(r["i"])("div",d,[Object(r["i"])("div",f,[Object(r["k"])(l,{type:"filled",onClicked:t[0]||(t[0]=function(t){return e.$router.push({name:"offerCreate"})})},{default:Object(r["P"])((function(){return[b,p]})),_:1})]),Object(r["i"])("div",h,[Object(r["k"])(l,{type:"outlined",onClicked:c.copy,disabled:!a.offerToCopy.length},{default:Object(r["P"])((function(){return[O]})),_:1},8,["onClicked","disabled"])])]),Object(r["i"])("div",j,[Object(r["k"])(T,{id:"offerSearch",placeholder:e.$isMobile?"Поиск":"Поиск по номеру КП, конечному заказчику, региону, контрагенту",search:!0,searchIcon:!0,suggestionWidth:380,suggestions:a.suggestions,onSetSuggestion:c.getOffers,onKeypressEnter:c.getOffers,onClear:t[1]||(t[1]=function(e){return a.query="",a.suggestions=[],c.getOffers()}),onInput:t[2]||(t[2]=function(e){return c.getOffers("search")}),modelValue:a.query,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.query=e})},null,8,["placeholder","suggestions","onSetSuggestion","onKeypressEnter","modelValue"])]),e.$isMobile?(Object(r["x"])(),Object(r["h"])("div",m,[Object.values(a.filters).some((function(e){return e}))?(Object(r["x"])(),Object(r["h"])("div",v,Object(r["J"])(Object.values(a.filters).filter((function(e){return""!==e})).length),1)):Object(r["g"])("",!0),Object(r["k"])(l,{type:"outlined",onClick:t[4]||(t[4]=function(t){return e.open=!0})},{default:Object(r["P"])((function(){return[g]})),_:1})])):Object(r["g"])("",!0)],2),!e.$isMobile||e.$isMobile&&e.open?(Object(r["x"])(),Object(r["h"])("div",{key:0,class:Object(r["s"])(["offer-filters page-wrapper",{open:e.showContent}])},[e.$isMobile?(Object(r["x"])(),Object(r["h"])("div",y,[Object(r["i"])("img",{src:i.a,alt:"Close",onClick:t[5]||(t[5]=function(){return e.closeDropdown&&e.closeDropdown.apply(e,arguments)})})])):Object(r["g"])("",!0),e.$isMobile?(Object(r["x"])(),Object(r["h"])("h4",_,"Фильтры")):Object(r["g"])("",!0),Object(r["i"])("div",k,[Object(r["k"])(T,{id:"offerSearchCounterparty",placeholder:"Контрагент",search:!0,suggestions:a.counterparties,onInput:t[6]||(t[6]=function(e){return c.getOffers("search")}),onKeypressEnter:c.getOffers,onSetSuggestion:t[7]||(t[7]=function(t){return c.getOffers(e.s)}),onClear:t[8]||(t[8]=function(e){return a.filters.counterparty="",a.counterparties=[]}),modelValue:a.filters.counterparty,"onUpdate:modelValue":t[9]||(t[9]=function(e){return a.filters.counterparty=e})},null,8,["suggestions","onKeypressEnter","modelValue"])]),Object(r["i"])("div",C,[Object(r["k"])(S,{options:a.regions,placeholder:"Регион",modelValue:a.filters.region,"onUpdate:modelValue":t[10]||(t[10]=function(e){return a.filters.region=e}),onChange:c.getOffers},null,8,["options","modelValue","onChange"])]),Object(r["i"])("div",x,[Object(r["k"])(S,{options:a.customers,placeholder:"Конечный заказчик",modelValue:a.filters.customer,"onUpdate:modelValue":t[11]||(t[11]=function(e){return a.filters.customer=e}),onChange:c.getOffers},null,8,["options","modelValue","onChange"])]),Object(r["i"])("div",w,[Object(r["k"])(S,{options:a.managers,placeholder:"Менеджер",modelValue:a.filters.manager,"onUpdate:modelValue":t[12]||(t[12]=function(e){return a.filters.manager=e}),onChange:c.getOffers},null,8,["options","modelValue","onChange"])]),e.$isMobile?(Object(r["x"])(),Object(r["h"])("div",$,[Object(r["i"])("div",V,[Object(r["k"])(l,{type:"filled",onClick:e.closeDropdown},{default:Object(r["P"])((function(){return[P]})),_:1},8,["onClick"])])])):Object(r["g"])("",!0)],2)):Object(r["g"])("",!0),Object(r["i"])("div",I,[Object(r["k"])(U,{offers:a.offers,onCopy:t[13]||(t[13]=function(e){a.offerToCopy=e}),onScroll:t[14]||(t[14]=function(e){a.scrollStart=e>0}),onScrolled:c.getNextPage},null,8,["offers","onScrolled"])])])}var S=n("ade3"),U=n("b85c"),J=(n("7db0"),n("b0c0"),n("d9e2"),n("d401"),n("be12")),E=n("304d"),M=(n("caad"),n("2532"),n("1aea")),q=n.n(M),D=n("0e34"),A=n.n(D),F=n("209a"),Q=n.n(F),R=n("8dbe"),z=n.n(R),N=function(e){return Object(r["A"])("data-v-bdcd9978"),e=e(),Object(r["y"])(),e},B={key:0,class:"offer-table"},K=N((function(){return Object(r["i"])("thead",null,[Object(r["i"])("tr",null,[Object(r["i"])("th"),Object(r["i"])("th",null,"Номер"),Object(r["i"])("th",null,"Дата создания"),Object(r["i"])("th",null,"Стоимость"),Object(r["i"])("th",null,"Контрагент"),Object(r["i"])("th",null,"Скидка"),Object(r["i"])("th",null,"Регион"),Object(r["i"])("th",null,"Файлы")])],-1)})),L={key:0,ref:"table"},G={class:"no-wrap"},H={class:"base-check"},W=["id","name","value","disabled"],Y=["for"],X=["onClick"],Z={class:"tooltip"},ee=["onClick"],te={class:"tooltip"},ne=["onClick"],re={class:"tooltip"},oe=["onClick"],ae={class:"tooltip"},ce=["onClick"],ie=["onClick"],le={class:"tooltip"},se={class:"no-wrap"},ue={class:"offer-actions"},de=["href"],fe=N((function(){return Object(r["i"])("img",{src:q.a,alt:"PDF",width:"29",height:"27"},null,-1)})),be=[fe],pe=["href"],he=N((function(){return Object(r["i"])("img",{src:A.a,alt:"Excel",width:"29",height:"27"},null,-1)})),Oe=[he],je=["href"],me=N((function(){return Object(r["i"])("img",{src:Q.a,alt:"Ru",width:"22",height:"27"},null,-1)})),ve=[me],ge={class:"offer-action _tz"},ye=N((function(){return Object(r["i"])("img",{src:z.a,alt:"Tz",width:"22",height:"27"},null,-1)})),_e={class:"offer-action-dropdown"},ke={class:"offer-action-dropdown-content"},Ce={class:"base-check radio"},xe=["id","value"],we=["for"],$e={class:"base-check radio"},Ve=["id","value"],Pe=["for"],Ie={class:"base-check radio"},Te=["id","value"],Se=["for"],Ue=N((function(){return Object(r["i"])("span",{class:"upp"},"ктру",-1)})),Je=Object(r["j"])(" сокр. "),Ee=[Ue,Je],Me=["href"],qe={key:1,class:"offer-table-mobile table-mobile",ref:"table"},De={class:"offer-table-mobile-checkbox"},Ae={class:"base-check"},Fe=["id","name","value","disabled"],Qe=["for"],Re=["onClick"],ze=N((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Номер ",-1)})),Ne={class:"table-mobile__value"},Be=["onClick"],Ke=N((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Дата созд. ",-1)})),Le={class:"table-mobile__value"},Ge=["onClick"],He=N((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Стоимость ",-1)})),We={class:"table-mobile__value"},Ye=["onClick"],Xe=N((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Контрагент ",-1)})),Ze={class:"table-mobile__value"},et=["onClick"],tt=N((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Скидка ",-1)})),nt={class:"table-mobile__value"},rt=["onClick"],ot=N((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Регион ",-1)})),at={class:"table-mobile__value"},ct={class:"offer-actions"},it=["href"],lt=N((function(){return Object(r["i"])("img",{src:q.a,alt:"PDF",width:"29",height:"27"},null,-1)})),st=[lt],ut=["href"],dt=N((function(){return Object(r["i"])("img",{src:A.a,alt:"Excel",width:"29",height:"27"},null,-1)})),ft=[dt],bt=["href"],pt=N((function(){return Object(r["i"])("img",{src:Q.a,alt:"Ru",width:"22",height:"27"},null,-1)})),ht=[pt],Ot={class:"offer-action _tz"},jt=N((function(){return Object(r["i"])("img",{src:z.a,alt:"Tz"},null,-1)})),mt={class:"offer-action-dropdown"},vt={class:"offer-action-dropdown-content"},gt={class:"base-check radio"},yt=["id","value"],_t=["for"],kt={class:"base-check radio"},Ct=["id","value"],xt=["for"],wt={class:"base-check radio"},$t=["id","value"],Vt=["for"],Pt=N((function(){return Object(r["i"])("span",{class:"upp"},"ктру",-1)})),It=Object(r["j"])(" сокр. "),Tt=[Pt,It],St=["href"],Ut={key:2,class:"offer-content-notFound content-notFound"};function Jt(e,t,n,o,a,c){var i=Object(r["G"])("tooltip");return Object(r["x"])(),Object(r["h"])(r["b"],null,[e.$isMobile?n.offers.length&&e.$isMobile?(Object(r["x"])(),Object(r["h"])("div",qe,[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.offers,(function(n,o){return Object(r["x"])(),Object(r["h"])("div",{class:"table-mobile-column",key:o},[Object(r["i"])("div",De,[Object(r["i"])("div",Ae,[Object(r["Q"])(Object(r["i"])("input",{type:"checkbox",id:n.id,name:n.id,value:n.id,disabled:a.offerToCopy.length&&!a.offerToCopy.includes(n.id),"onUpdate:modelValue":t[4]||(t[4]=function(e){return a.offerToCopy=e})},null,8,Fe),[[r["L"],a.offerToCopy]]),Object(r["i"])("label",{for:n.id},null,8,Qe)])]),Object(r["i"])("div",{class:"table-mobile-row",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[ze,Object(r["i"])("span",Ne,Object(r["J"])(n.id),1)],8,Re),Object(r["i"])("div",{class:"table-mobile-row",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Ke,Object(r["i"])("span",Le,Object(r["J"])(n.created_at),1)],8,Be),Object(r["i"])("div",{class:"table-mobile-row",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[He,Object(r["i"])("span",We,Object(r["J"])(n.total_cost)+" ₽ ",1)],8,Ge),Object(r["i"])("div",{class:"table-mobile-row",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Xe,Object(r["i"])("span",Ze,Object(r["J"])(n.counterparty.name),1)],8,Ye),Object(r["i"])("div",{class:"table-mobile-row",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[tt,Object(r["i"])("span",nt,Object(r["J"])(n.counterparty.discount)+"% ",1)],8,et),Object(r["i"])("div",{class:"table-mobile-row",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[ot,Object(r["i"])("span",at,Object(r["J"])(n.end_customer&&n.end_customer.region),1)],8,rt),Object(r["i"])("div",ct,[Object(r["i"])("a",{href:n.kp_pdf_file,class:"offer-action _pdf"},st,8,it),Object(r["i"])("a",{href:n.kp_exel_file,class:"offer-action _excel"},ft,8,ut),Object(r["i"])("a",{href:n.ru_file,class:"offer-action _ru"},ht,8,bt),Object(r["i"])("div",Ot,[jt,Object(r["i"])("div",mt,[Object(r["i"])("div",vt,[Object(r["i"])("div",gt,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"ktru".concat(n.id),value:n.krtu_file,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.downloadType=e})},null,8,yt),[[r["M"],a.downloadType]]),Object(r["i"])("label",{for:"ktru".concat(n.id),class:"upp"}," ктру ",8,_t)]),Object(r["i"])("div",kt,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"tu".concat(n.id),value:n.krtu_avg_file,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.downloadType=e})},null,8,Ct),[[r["M"],a.downloadType]]),Object(r["i"])("label",{for:"tu".concat(n.id),class:"upp"}," ту ",8,xt)]),Object(r["i"])("div",wt,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"ktrus".concat(n.id),value:n.krtu_gost_file,"onUpdate:modelValue":t[7]||(t[7]=function(e){return a.downloadType=e})},null,8,$t),[[r["M"],a.downloadType]]),Object(r["i"])("label",{for:"ktrus".concat(n.id)},Tt,8,Vt)]),Object(r["i"])("a",{href:a.downloadType,class:"offer-action__button"}," Скачать ",8,St)])])])])])})),128))],512)):Object(r["g"])("",!0):(Object(r["x"])(),Object(r["h"])("table",B,[K,n.offers.length?(Object(r["x"])(),Object(r["h"])("tbody",L,[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.offers,(function(n){return Object(r["x"])(),Object(r["h"])("tr",{key:n.id},[Object(r["i"])("td",G,[Object(r["i"])("div",H,[Object(r["Q"])(Object(r["i"])("input",{type:"checkbox",id:n.id,name:n.id,value:n.id,disabled:a.offerToCopy.length&&!a.offerToCopy.includes(n.id),"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.offerToCopy=e})},null,8,W),[[r["L"],a.offerToCopy]]),Object(r["i"])("label",{for:n.id},null,8,Y)])]),Object(r["i"])("td",{onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Object(r["i"])("span",null,Object(r["J"])(n.id),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",Z,[Object(r["j"])(Object(r["J"])(n.id),1)])),[[i]])],8,X),Object(r["i"])("td",{onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Object(r["i"])("span",null,Object(r["J"])(n.created_at),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",te,[Object(r["j"])(Object(r["J"])(n.created_at),1)])),[[i]])],8,ee),Object(r["i"])("td",{onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Object(r["i"])("span",null,Object(r["J"])(n.total_cost)+" ₽ ",1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",re,[Object(r["j"])(Object(r["J"])(n.total_cost)+" ₽ ",1)])),[[i]])],8,ne),Object(r["i"])("td",{onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Object(r["i"])("span",null,Object(r["J"])(n.counterparty.name),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",ae,[Object(r["j"])(Object(r["J"])(n.counterparty.name),1)])),[[i]])],8,oe),Object(r["i"])("td",{class:"no-wrap",onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Object(r["i"])("span",null,Object(r["J"])(n.counterparty.discount)+"% ",1)],8,ce),Object(r["i"])("td",{onClick:function(t){return e.$router.push({name:"offerCreate",query:{id:n.id}})}},[Object(r["i"])("span",null,Object(r["J"])(n.end_customer&&n.end_customer.region),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",le,[Object(r["j"])(Object(r["J"])(n.end_customer&&n.end_customer.region),1)])),[[i]])],8,ie),Object(r["i"])("td",se,[Object(r["i"])("div",ue,[Object(r["i"])("a",{href:n.kp_pdf_file,class:"offer-action _pdf"},be,8,de),Object(r["i"])("a",{href:n.kp_exel_file,class:"offer-action _excel"},Oe,8,pe),Object(r["i"])("a",{href:n.ru_file,class:"offer-action _ru"},ve,8,je),Object(r["i"])("div",ge,[ye,Object(r["i"])("div",_e,[Object(r["i"])("div",ke,[Object(r["i"])("div",Ce,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"ktru".concat(n.id),value:n.krtu_file,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.downloadType=e})},null,8,xe),[[r["M"],a.downloadType]]),Object(r["i"])("label",{for:"ktru".concat(n.id),class:"upp"}," ктру ",8,we)]),Object(r["i"])("div",$e,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"tu".concat(n.id),value:n.krtu_avg_file,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.downloadType=e})},null,8,Ve),[[r["M"],a.downloadType]]),Object(r["i"])("label",{for:"tu".concat(n.id),class:"upp"}," ту ",8,Pe)]),Object(r["i"])("div",Ie,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"ktrus".concat(n.id),value:n.krtu_gost_file,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.downloadType=e})},null,8,Te),[[r["M"],a.downloadType]]),Object(r["i"])("label",{for:"ktrus".concat(n.id)},Ee,8,Se)]),Object(r["i"])("a",{href:a.downloadType,class:"offer-action__button"}," Скачать ",8,Me)])])])])])])})),128))],512)):Object(r["g"])("",!0)])),n.offers.length?Object(r["g"])("",!0):(Object(r["x"])(),Object(r["h"])("span",Ut," Ничего не найдено "))],64)}n("b680");var Et={name:"OfferTable",props:{offers:{type:Array}},data:function(){return{offerToCopy:[],downloadType:"#"}},mounted:function(){var e=this;setTimeout((function(){var t=e.$refs.table;t&&t.addEventListener("scroll",(function(){e.onScroll(t)}))}),1e3)},methods:{onScroll:function(e){var t=+e.getBoundingClientRect().height.toFixed(0),n=+e.scrollHeight.toFixed(0),r=+e.scrollTop.toFixed(0);this.$emit("scroll",r),r+t==n&&this.$emit("scrolled")}},watch:{offerToCopy:function(){this.$emit("copy",this.offerToCopy)}},emits:["download","scroll","scrolled","copy"]},Mt=(n("82cc"),n("6b0d")),qt=n.n(Mt);const Dt=qt()(Et,[["render",Jt],["__scopeId","data-v-bdcd9978"]]);var At=Dt,Ft={components:{BaseSelect:J["a"],OffersTable:At},data:function(){return{query:"",scrollStart:!1,filters:{counterparty:"",region:"",customer:"",manager:""},regions:[{key:"Не Выбран",value:""}],customers:[{key:"Не Выбран",value:""}],page:1,hasNext:!1,offerToCopy:[],offers:[],counterparties:[],suggestions:[],managers:[]}},mounted:function(){this.getOffers(),this.getRegions()},methods:{copy:function(){var e=this,t=this.offers.find((function(t){return t.id==e.offerToCopy[0]})),n=[];if(t.offer_products.length){var r,o=Object(U["a"])(t.offer_products);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push({product:a.product,price:a.price,discount:a.discount,count:a.count,cost:a.cost})}}catch(i){o.e(i)}finally{o.f()}}var c={counterparty:t.counterparty&&t.counterparty.id||null,end_customer:t.end_customer&&t.end_customer.id||null,company:t.company&&t.company.id||null,offer_products:n||[],tech_docs_format:t.tech_docs_format};this.$api.post("".concat(this.$api.defaults.API,"/offer"),c).then((function(t){e.$router.push({name:"offerCreate",query:{id:t.data.id}})}))},getOffers:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"loading"!==n&&(this.page=1),"search"!==n&&this.$store.dispatch("loading",!0);var r=(e={page:this.page},Object(S["a"])(e,this.query&&"search",this.query),Object(S["a"])(e,this.filters.counterparty&&"counterparty",this.filters.counterparty),Object(S["a"])(e,this.filters.customer&&"end_customer",this.filters.customer),Object(S["a"])(e,this.filters.region&&"end_customer__region",this.filters.region),e);this.counterparties=[],this.suggestions=[],this.customers=[{key:"Не Выбран",value:""}],this.$api.get("".concat(this.$api.defaults.API,"/offer"),{params:r}).then((function(e){console.log(e.data),t.hasNext=e.data.next,t.$store.dispatch("loading",!1),"search"!==n&&"loading"!==n&&(t.offers=[]);var r,o=Object(U["a"])(e.data.results);try{var a=function(){var e=r.value;"search"!==n&&t.offers.push(e),"search"==n&&t.query&&t.suggestions.push({key:e.id,value:e.id});var o={key:e.end_customer?e.end_customer.name:"",value:e.end_customer?e.end_customer.id:""};if(!t.customers.find((function(e){return e.value===o.value}))&&o.key&&t.customers.push(o),"search"==n){var a={key:e.counterparty.name,value:e.counterparty.id};!t.counterparties.find((function(e){return e.value===a.value}))&&a.key&&t.filters.counterparty&&t.counterparties.push(a)}};for(o.s();!(r=o.n()).done;)a()}catch(c){o.e(c)}finally{o.f()}})).catch((function(e){new Error(e),t.$store.dispatch("loading",!1),n||(t.offers=[])}))},getRegions:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/regions")).then((function(t){var n,r=Object(U["a"])(t.data);try{var o=function(){var t=n.value,r={key:t.region,value:t.region};!e.regions.some((function(e){return e.key==r.key}))&&e.regions.push(r)};for(r.s();!(n=r.n()).done;)o()}catch(a){r.e(a)}finally{r.f()}}))},getNextPage:function(){this.hasNext&&(this.page++,this.getOffers("loading"))}},mixins:[E["a"]]};n("41c7");const Qt=qt()(Ft,[["render",T],["__scopeId","data-v-a22f56ba"]]);t["default"]=Qt},edf2:function(e,t,n){"use strict";n("9c58")},f26d:function(e,t,n){"use strict";n("417c")}}]);
//# sourceMappingURL=offers.7dc7b4e3.js.map