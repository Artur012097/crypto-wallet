(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["offerCreate"],{"09ca":function(e,t,n){"use strict";n("723b")},"0cb2":function(e,t,n){var r=n("e330"),a=n("7b0b"),o=Math.floor,c=r("".charAt),i=r("".replace),u=r("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,f){var b=n+e.length,p=r.length,h=s;return void 0!==d&&(d=a(d),h=l),i(f,h,(function(a,i){var l;switch(c(i,0)){case"$":return"$";case"&":return e;case"`":return u(t,0,n);case"'":return u(t,b);case"<":l=d[u(i,1,-1)];break;default:var s=+i;if(0===s)return a;if(s>p){var f=o(s/10);return 0===f?a:f<=p?void 0===r[f-1]?c(i,1):r[f-1]+c(i,1):a}l=r[s-1]}return void 0===l?"":l}))}},1148:function(e,t,n){"use strict";var r=n("da84"),a=n("5926"),o=n("577e"),c=n("1d80"),i=r.RangeError;e.exports=function(e){var t=o(c(this)),n="",r=a(e);if(r<0||r==1/0)throw i("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},1276:function(e,t,n){"use strict";var r=n("2ba4"),a=n("c65b"),o=n("e330"),c=n("d784"),i=n("44e7"),u=n("825a"),l=n("1d80"),s=n("4840"),d=n("8aa5"),f=n("50c4"),b=n("577e"),p=n("dc4a"),h=n("4dae"),m=n("14c3"),O=n("9263"),j=n("9f7f"),v=n("d039"),y=j.UNSUPPORTED_Y,g=4294967295,_=Math.min,C=[].push,x=o(/./.exec),k=o(C),V=o("".slice),w=!v((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));c("split",(function(e,t,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var o=b(l(this)),c=void 0===n?g:n>>>0;if(0===c)return[];if(void 0===e)return[o];if(!i(e))return a(t,o,e,c);var u,s,d,f=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,j=new RegExp(e.source,p+"g");while(u=a(O,j,o)){if(s=j.lastIndex,s>m&&(k(f,V(o,m,u.index)),u.length>1&&u.index<o.length&&r(C,f,h(u,1)),d=u[0].length,m=s,f.length>=c))break;j.lastIndex===u.index&&j.lastIndex++}return m===o.length?!d&&x(j,"")||k(f,""):k(f,V(o,m)),f.length>c?h(f,0,c):f}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:a(t,this,e,n)}:t,[function(t,n){var r=l(this),c=void 0==t?void 0:p(t,e);return c?a(c,t,r,n):a(o,b(r),t,n)},function(e,r){var a=u(this),c=b(e),i=n(o,a,c,r,o!==t);if(i.done)return i.value;var l=s(a,RegExp),p=a.unicode,h=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(y?"g":"y"),O=new l(y?"^(?:"+a.source+")":a,h),j=void 0===r?g:r>>>0;if(0===j)return[];if(0===c.length)return null===m(O,c)?[c]:[];var v=0,C=0,x=[];while(C<c.length){O.lastIndex=y?0:C;var w,P=m(O,y?V(c,C):c);if(null===P||(w=_(f(O.lastIndex+(y?C:0)),c.length))===v)C=d(c,C,p);else{if(k(x,V(c,v,C)),x.length===j)return x;for(var $=1;$<=P.length-1;$++)if(k(x,P[$]),x.length===j)return x;C=v=w}}return k(x,V(c,v)),x}]}),!w,y)},"417c":function(e,t,n){},"4fadc":function(e,t,n){var r=n("23e7"),a=n("6f53").entries;r({target:"Object",stat:!0},{entries:function(e){return a(e)}})},5319:function(e,t,n){"use strict";var r=n("2ba4"),a=n("c65b"),o=n("e330"),c=n("d784"),i=n("d039"),u=n("825a"),l=n("1626"),s=n("5926"),d=n("50c4"),f=n("577e"),b=n("1d80"),p=n("8aa5"),h=n("dc4a"),m=n("0cb2"),O=n("14c3"),j=n("b622"),v=j("replace"),y=Math.max,g=Math.min,_=o([].concat),C=o([].push),x=o("".indexOf),k=o("".slice),V=function(e){return void 0===e?e:String(e)},w=function(){return"$0"==="a".replace(/./,"$0")}(),P=function(){return!!/./[v]&&""===/./[v]("a","$0")}(),$=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));c("replace",(function(e,t,n){var o=P?"$":"$0";return[function(e,n){var r=b(this),o=void 0==e?void 0:h(e,v);return o?a(o,e,r,n):a(t,f(r),e,n)},function(e,a){var c=u(this),i=f(e);if("string"==typeof a&&-1===x(a,o)&&-1===x(a,"$<")){var b=n(t,c,i,a);if(b.done)return b.value}var h=l(a);h||(a=f(a));var j=c.global;if(j){var v=c.unicode;c.lastIndex=0}var w=[];while(1){var P=O(c,i);if(null===P)break;if(C(w,P),!j)break;var $=f(P[0]);""===$&&(c.lastIndex=p(i,d(c.lastIndex),v))}for(var I="",S=0,U=0;U<w.length;U++){P=w[U];for(var E=f(P[0]),T=y(g(s(P.index),i.length),0),A=[],D=1;D<P.length;D++)C(A,V(P[D]));var J=P.groups;if(h){var R=_([E],A,T,i);void 0!==J&&C(R,J);var M=f(r(a,void 0,R))}else M=m(E,i,T,A,J,a);T>=S&&(I+=k(i,S,T)+M,S=T+E.length)}return I+k(i,S)}]}),!$||!w||P)},"5f91":function(e,t,n){},"6c47":function(e,t,n){"use strict";n("84f2")},"6f53":function(e,t,n){var r=n("83ab"),a=n("e330"),o=n("df75"),c=n("fc6a"),i=n("d1e7").f,u=a(i),l=a([].push),s=function(e){return function(t){var n,a=c(t),i=o(a),s=i.length,d=0,f=[];while(s>d)n=i[d++],r&&!u(a,n)||l(f,e?[n,a[n]]:a[n]);return f}};e.exports={entries:s(!0),values:s(!1)}},7197:function(e,t,n){"use strict";n.r(t);var r=n("7a23"),a=function(e){return Object(r["A"])("data-v-51b12b4c"),e=e(),Object(r["y"])(),e},o={class:"offer-create"},c={class:"offer-create__title page__title"},i=Object(r["j"])(" Коммерческое предложение "),u={key:0},l={key:1,class:"offer-create__title-date"},s={class:"offer-create-wrapper page-wrapper"},d={class:"offer-create-fields fields"},f={class:"offer-create-fields-row fields-row"},b={class:"offer-create-fields-row fields-row"},p={class:"offer-create-fields-row fields-row _area"},h={class:"offer-create-fields-row fields-row"},m={class:"offer-create-fields-row fields-row"},O={class:"offer-create-fields-row fields-row"},j={class:"offer-create-fields-row fields-row _validy"},v={class:"offer-create-fields-row fields-row _area"},y={class:"offer-create-fields-row fields-row"},g={class:"offer-create-products"},_=a((function(){return Object(r["i"])("h2",{class:"offer-create-products__title"},"Продукция",-1)})),C={class:"offer-create-products-row article-row"},x={class:"offer-create-products-field article-row-field"},k={class:"offer-create-products-add article-row-button"},V=Object(r["j"])(" Добавить "),w=a((function(){return Object(r["i"])("h3",{class:"offer-create-company__title"},"Выбрать компанию",-1)})),P={class:"offer-create-company__select"},$={class:"offer-create-type"},I=a((function(){return Object(r["i"])("h4",{class:"offer-create-type__title"},"Сохранить",-1)})),S={class:"offer-create-types"},U={class:"base-check"},E=a((function(){return Object(r["i"])("label",{for:"offerCreatePdf",class:"upp"}," pdf ",-1)})),T={class:"base-check _excel"},A=a((function(){return Object(r["i"])("label",{for:"offerCreateExcel"}," Excel ",-1)})),D={class:"offer-create-type _get-ready"},J=a((function(){return Object(r["i"])("h4",{class:"offer-create-type__title _get-ready"},"Подготовить",-1)})),R={class:"offer-create-types _get-ready"},M={class:"base-check"},z=a((function(){return Object(r["i"])("label",{for:"offerReadyTz",class:"upp"}," тз ",-1)})),B={class:"base-check upp _ru"},F=a((function(){return Object(r["i"])("label",{for:"offerReadyRu",class:"upp"}," ру ",-1)})),N={key:0,class:"offer-create-tzType"},K=a((function(){return Object(r["i"])("h5",null,"Тип",-1)})),L={class:"base-check radio"},Q=a((function(){return Object(r["i"])("label",{for:"offerCreateKtru",class:"upp"}," ктру ",-1)})),q={class:"base-check radio"},G=a((function(){return Object(r["i"])("label",{for:"offerCreateTu",class:"upp"}," ту ",-1)})),Y={class:"base-check radio"},H=a((function(){return Object(r["i"])("label",{for:"offerCreateKtrus"},[Object(r["i"])("span",{class:"upp"},"ктру"),Object(r["j"])(" сокр. ")],-1)})),W={class:"offer-create-actions page-buttons"},X={class:"offer-create__send"},Z=Object(r["j"])(" Отправить "),ee={class:"offer-create__save"},te=Object(r["j"])(" Сохранить "),ne={class:"offer-create__dl"},re=Object(r["j"])(" Скачать ");function ae(e,t,n,a,ae,oe){var ce=Object(r["F"])("base-input"),ie=Object(r["F"])("base-textarea"),ue=Object(r["F"])("base-button"),le=Object(r["F"])("offer-create-table"),se=Object(r["F"])("base-select"),de=Object(r["F"])("base-modal");return Object(r["x"])(),Object(r["h"])(r["b"],null,[Object(r["i"])("section",o,[Object(r["i"])("h1",c,[i,oe.edit&&ae.offer?(Object(r["x"])(),Object(r["h"])("span",u,"№"+Object(r["J"])(ae.offer.id),1)):Object(r["g"])("",!0),oe.edit&&ae.offer?(Object(r["x"])(),Object(r["h"])("span",l,Object(r["J"])(oe.offerDate),1)):Object(r["g"])("",!0)]),Object(r["i"])("div",s,[Object(r["i"])("div",d,[Object(r["i"])("div",f,[Object(r["k"])(ce,{label:"Контрагент",id:"offerCreatecounterparty",suggestions:ae.counterparties,search:!0,onSetSuggestion:oe.getCounterparty,onKeypressEnter:oe.getCounterparty,onInput:oe.getCounterparties,modelValue:ae.data.counterparty,"onUpdate:modelValue":t[0]||(t[0]=function(e){return ae.data.counterparty=e})},null,8,["suggestions","onSetSuggestion","onKeypressEnter","onInput","modelValue"])]),Object(r["i"])("div",b,[Object(r["k"])(ce,{label:"ИНН",id:"offerCreateInn",disbled:!0,disabled:ae.data.inn&&!0,readonly:ae.data.inn&&!0,modelValue:ae.data.inn,"onUpdate:modelValue":t[1]||(t[1]=function(e){return ae.data.inn=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",p,[Object(r["k"])(ie,{label:"Адрес",id:"offerCreateAddress",disabled:ae.data.address&&!0,readonly:ae.data.address&&!0,modelValue:ae.data.address,"onUpdate:modelValue":t[2]||(t[2]=function(e){return ae.data.address=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",h,[Object(r["k"])(ce,{label:"Телефон",id:"offerCreatePhone",disabled:ae.data.phone&&!0,readonly:ae.data.phone&&!0,modelValue:ae.data.phone,"onUpdate:modelValue":t[3]||(t[3]=function(e){return ae.data.phone=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",m,[Object(r["k"])(ce,{label:"Электронная почта",id:"offerCreateEmail",disabled:ae.data.email&&!0,readonly:ae.data.email&&!0,modelValue:ae.data.email,"onUpdate:modelValue":t[4]||(t[4]=function(e){return ae.data.email=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",O,[Object(r["k"])(ce,{label:"Контактное лицо",id:"offerCreateContact",disabled:ae.data.contactPerson&&!0,readonly:ae.data.contactPerson&&!0,modelValue:ae.data.contactPerson,"onUpdate:modelValue":t[5]||(t[5]=function(e){return ae.data.contactPerson=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",j,[Object(r["k"])(ce,{label:"Срок действия",short:!0,id:"offerCreateValidy",disabled:ae.data.validy&&!0,readonly:ae.data.validy&&!0,modelValue:ae.data.validy,"onUpdate:modelValue":t[6]||(t[6]=function(e){return ae.data.validy=e})},null,8,["disabled","readonly","modelValue"])]),Object(r["i"])("div",v,[Object(r["k"])(ce,{label:"Конечный заказчик",id:"offerCreateEndCustomer",suggestions:ae.customers,search:!0,onSetSuggestion:oe.setCustomer,onKeypressEnter:oe.setCustomer,onInput:oe.getEndCustomer,modelValue:ae.data.endCustomer,"onUpdate:modelValue":t[7]||(t[7]=function(e){return ae.data.endCustomer=e})},null,8,["suggestions","onSetSuggestion","onKeypressEnter","onInput","modelValue"])]),Object(r["i"])("div",y,[Object(r["k"])(ce,{label:"Регион",id:"offerCreateRegion",disabled:ae.data.region&&!0,readonly:ae.data.region&&!0,modelValue:ae.data.region,"onUpdate:modelValue":t[8]||(t[8]=function(e){return ae.data.region=e})},null,8,["disabled","readonly","modelValue"])])]),Object(r["i"])("div",g,[_,Object(r["i"])("div",C,[Object(r["i"])("div",x,[Object(r["k"])(ce,{id:"offerCreatecounterpartyProduct",placeholder:"Артикул или наименование",search:!0,suggestions:ae.productSuggestions,onSetSuggestion:oe.getProducts,onKeypressEnter:oe.getProducts,onInput:t[9]||(t[9]=function(e){return oe.getProducts("search")}),modelValue:ae.productsSearch,"onUpdate:modelValue":t[10]||(t[10]=function(e){return ae.productsSearch=e})},null,8,["suggestions","onSetSuggestion","onKeypressEnter","modelValue"])]),Object(r["i"])("div",k,[Object(r["k"])(ue,{type:"outlined",onClicked:oe.addProduct},{default:Object(r["P"])((function(){return[V]})),_:1},8,["onClicked"])])]),Object(r["k"])(le,{products:ae.products,onEditProduct:oe.editProduct,onRemoveProduct:oe.removeProduct},null,8,["products","onEditProduct","onRemoveProduct"])]),Object(r["i"])("div",{class:Object(r["s"])(["offer-create-company",{filled:ae.products.length}])},[w,Object(r["i"])("div",P,[Object(r["k"])(se,{options:ae.companies,modelValue:ae.data.company,"onUpdate:modelValue":t[11]||(t[11]=function(e){return ae.data.company=e}),borderOnly:!0},null,8,["options","modelValue"])])],2),Object(r["i"])("div",$,[I,Object(r["i"])("div",S,[Object(r["i"])("div",U,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreatePdf",value:"pdf","onUpdate:modelValue":t[12]||(t[12]=function(e){return ae.data.tech_docs_format=e})},null,512),[[r["M"],ae.data.tech_docs_format]]),E]),Object(r["i"])("div",T,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateExcel",value:"excel","onUpdate:modelValue":t[13]||(t[13]=function(e){return ae.data.tech_docs_format=e})},null,512),[[r["M"],ae.data.tech_docs_format]]),A])])]),Object(r["i"])("div",D,[J,Object(r["i"])("div",R,[Object(r["i"])("div",M,[Object(r["Q"])(Object(r["i"])("input",{type:"checkbox",id:"offerReadyTz","onUpdate:modelValue":t[14]||(t[14]=function(e){return ae.data.tz=e})},null,512),[[r["L"],ae.data.tz]]),z]),Object(r["i"])("div",B,[Object(r["Q"])(Object(r["i"])("input",{type:"checkbox",id:"offerReadyRu","onUpdate:modelValue":t[15]||(t[15]=function(e){return ae.data.ru=e})},null,512),[[r["L"],ae.data.ru]]),F])]),ae.data.tz?(Object(r["x"])(),Object(r["h"])("div",N,[K,Object(r["i"])("div",null,[Object(r["i"])("div",L,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateKtru",value:"ktru","onUpdate:modelValue":t[16]||(t[16]=function(e){return ae.data.tzType=e})},null,512),[[r["M"],ae.data.tzType]]),Q]),Object(r["i"])("div",q,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateTu",value:"tu","onUpdate:modelValue":t[17]||(t[17]=function(e){return ae.data.tzType=e})},null,512),[[r["M"],ae.data.tzType]]),G]),Object(r["i"])("div",Y,[Object(r["Q"])(Object(r["i"])("input",{type:"radio",id:"offerCreateKtrus",value:"ktrus","onUpdate:modelValue":t[18]||(t[18]=function(e){return ae.data.tzType=e})},null,512),[[r["M"],ae.data.tzType]]),H])])])):Object(r["g"])("",!0)])]),Object(r["i"])("div",W,[Object(r["i"])("div",X,[Object(r["k"])(ue,{type:"filled",onClicked:oe.sendToEmail},{default:Object(r["P"])((function(){return[Z]})),_:1},8,["onClicked"])]),Object(r["i"])("div",ee,[Object(r["k"])(ue,{type:"outlined",onClicked:oe.saveOffer},{default:Object(r["P"])((function(){return[te]})),_:1},8,["onClicked"])]),Object(r["i"])("div",ne,[Object(r["k"])(ue,{type:"outlined"},{default:Object(r["P"])((function(){return[re]})),_:1})])])]),Object(r["k"])(de,{open:ae.openModal,text:ae.modalText,onClose:t[19]||(t[19]=function(e){return ae.openModal=!1})},null,8,["open","text"])],64)}var oe=n("3835"),ce=n("ade3"),ie=n("b85c"),ue=(n("99af"),n("b0c0"),n("45fc"),n("d3b7"),n("c740"),n("a434"),n("4fadc"),n("213a")),le=["for"],se=["id","name","required","disabled","readonly","placeholder","value","minLength","maxlength"],de={key:1,class:"based-textarea__msg"};function fe(e,t,n,a,o,c){return Object(r["x"])(),Object(r["h"])("div",{class:Object(r["s"])(["based-textarea",{"based-textarea-error":n.message,"based-textarea-row":n.label}])},[n.label?(Object(r["x"])(),Object(r["h"])("label",{key:0,for:n.id},Object(r["J"])(n.label),9,le)):Object(r["g"])("",!0),Object(r["i"])("textarea",{ref:"textarea",class:Object(r["s"])({error:n.error}),id:n.id,name:n.id,required:n.required,disabled:n.disabled,readonly:n.readonly,placeholder:n.placeholder,value:n.modelValue,minLength:n.minLength?n.minLength:"",maxlength:n.maxLength?n.maxLength:"",onInput:t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t.target.value),e.$emit("input")}),onFocus:t[1]||(t[1]=function(t){return e.$emit("focus")}),onBlur:t[2]||(t[2]=function(t){return e.$emit("blur")}),onClick:t[3]||(t[3]=function(t){return e.$emit("click")}),onKeypress:[t[4]||(t[4]=Object(r["R"])((function(t){return e.$emit("keypressEnter")}),["enter"])),t[5]||(t[5]=function(t){return e.$emit("keypress")})]},null,42,se),n.error?(Object(r["x"])(),Object(r["h"])("span",de,Object(r["J"])(n.message),1)):Object(r["g"])("",!0)],2)}n("a9e3");var be={name:"BaseTextarea",props:{id:{type:String},label:{type:String,default:""},error:{type:Boolean,default:!1},required:{type:Boolean},message:{type:String,default:""},placeholder:{type:String,default:""},modelValue:{type:[String,Number],required:!0},minLength:{type:Number},maxLength:{type:Number},disabled:{type:Boolean},readonly:{type:Boolean}},methods:{},emits:["update:modelValue","clear","input","focus","blur","click","keypressEnter","keypress"]},pe=(n("f26d"),n("6b0d")),he=n.n(pe);const me=he()(be,[["render",fe],["__scopeId","data-v-10dfe7a2"]]);var Oe=me,je=n("be12"),ve=n("c8de"),ye=n.n(ve),ge=function(e){return Object(r["A"])("data-v-e3832e78"),e=e(),Object(r["y"])(),e},_e={key:0,class:"offer-create-table"},Ce=ge((function(){return Object(r["i"])("thead",null,[Object(r["i"])("tr",null,[Object(r["i"])("th",null,"Артикул"),Object(r["i"])("th",null,"Наименование"),Object(r["i"])("th",null,"Цена"),Object(r["i"])("th",null,"Кол-во"),Object(r["i"])("th",null,"Скидка"),Object(r["i"])("th",null,"Стоимость"),Object(r["i"])("th")])],-1)})),xe={key:0},ke={class:"tooltip"},Ve={class:"tooltip"},we={class:"no-wrap"},Pe={class:"no-wrap"},$e={class:"no-wrap"},Ie={class:"tooltip"},Se={class:"no-wrap"},Ue=["onClick"],Ee=ge((function(){return Object(r["i"])("img",{src:ye.a,alt:"Remove"},null,-1)})),Te=[Ee],Ae={key:1,class:"offer-create-table-mobile table-mobile",ref:"table"},De=["onClick"],Je=ge((function(){return Object(r["i"])("img",{src:ye.a,alt:"Remove"},null,-1)})),Re=[Je],Me={class:"table-mobile-row"},ze=ge((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Артикул ",-1)})),Be={class:"table-mobile__value"},Fe={class:"table-mobile-row"},Ne=ge((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Наим-ие ",-1)})),Ke={class:"table-mobile__value"},Le={class:"table-mobile-row"},Qe=ge((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Цена ",-1)})),qe={class:"table-mobile__value"},Ge={class:"table-mobile-row"},Ye=ge((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Кол-во ",-1)})),He={class:"table-mobile__value"},We={class:"table-mobile-row"},Xe=ge((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Скидка ",-1)})),Ze={class:"table-mobile__value"},et={class:"table-mobile-row"},tt=ge((function(){return Object(r["i"])("span",{class:"table-mobile__title"}," Стоимость ",-1)})),nt={class:"table-mobile__value"},rt={key:2,class:"offer-create-price"},at={class:"offer-create-price__discount"},ot=ge((function(){return Object(r["i"])("span",null," Скидка ",-1)})),ct={class:"offer-create-price__total"},it=ge((function(){return Object(r["i"])("span",null," Общая стоимость ",-1)}));function ut(e,t,n,a,o,c){var i=Object(r["F"])("base-input"),u=Object(r["G"])("tooltip");return Object(r["x"])(),Object(r["h"])(r["b"],null,[e.$isMobile?n.products.length&&e.$isMobile?(Object(r["x"])(),Object(r["h"])("div",Ae,[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.products,(function(t,n){return Object(r["x"])(),Object(r["h"])("div",{class:"table-mobile-column",key:n},[Object(r["i"])("span",{class:"_remove",onClick:function(){e.$emit("removeProduct",t.id)}},Re,8,De),Object(r["i"])("div",Me,[ze,Object(r["i"])("span",Be,Object(r["J"])(t.article),1)]),Object(r["i"])("div",Fe,[Ne,Object(r["i"])("span",Ke,Object(r["J"])(t.name),1)]),Object(r["i"])("div",Le,[Qe,Object(r["i"])("span",qe,[Object(r["k"])(i,{type:"text",tableInput:!0,symbol:",00 ₽",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.price,"onUpdate:modelValue":function(e){return t.price=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])])]),Object(r["i"])("div",Ge,[Ye,Object(r["i"])("span",He,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"шт",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.count,"onUpdate:modelValue":function(e){return t.count=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])])]),Object(r["i"])("div",We,[Xe,Object(r["i"])("span",Ze,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"%",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.discount,"onUpdate:modelValue":function(e){return t.discount=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])])]),Object(r["i"])("div",et,[tt,Object(r["i"])("span",nt,Object(r["J"])(t.cost)+",00 ₽ ",1)])])})),128))],512)):Object(r["g"])("",!0):(Object(r["x"])(),Object(r["h"])("table",_e,[Ce,n.products.length?(Object(r["x"])(),Object(r["h"])("tbody",xe,[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.products,(function(t,n){return Object(r["x"])(),Object(r["h"])("tr",{key:n},[Object(r["i"])("td",null,[Object(r["i"])("span",null,Object(r["J"])(t.article),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",ke,[Object(r["j"])(Object(r["J"])(t.article),1)])),[[u]])]),Object(r["i"])("td",null,[Object(r["i"])("span",null,Object(r["J"])(t.name),1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",Ve,[Object(r["j"])(Object(r["J"])(t.name),1)])),[[u]])]),Object(r["i"])("td",we,[Object(r["k"])(i,{type:"text",tableInput:!0,symbol:",00 ₽",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.price,"onUpdate:modelValue":function(e){return t.price=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])]),Object(r["i"])("td",Pe,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"шт",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.count,"onUpdate:modelValue":function(e){return t.count=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])]),Object(r["i"])("td",$e,[Object(r["k"])(i,{type:"number",tableInput:!0,symbol:"%",onInput:function(n){return e.$emit("editProduct",t.id)},modelValue:t.discount,"onUpdate:modelValue":function(e){return t.discount=e}},null,8,["onInput","modelValue","onUpdate:modelValue"])]),Object(r["i"])("td",null,[Object(r["i"])("span",null,Object(r["J"])(t.cost)+",00 ₽ ",1),Object(r["Q"])((Object(r["x"])(),Object(r["h"])("span",Ie,[Object(r["j"])(Object(r["J"])(t.cost)+",00 ₽ ",1)])),[[u]])]),Object(r["i"])("td",Se,[Object(r["i"])("span",{class:"_remove",onClick:function(){e.$emit("removeProduct",t.id)}},Te,8,Ue)])])})),128))])):Object(r["g"])("",!0)])),n.products.length?(Object(r["x"])(),Object(r["h"])("div",rt,[Object(r["i"])("div",null,[Object(r["i"])("div",at,[ot,Object(r["i"])("span",null,Object(r["J"])(c.validateNumberString(c.totalDiscountedPrice))+",00 ₽ ",1)]),Object(r["i"])("div",ct,[it,Object(r["i"])("span",null,Object(r["J"])(c.validateNumberString(c.totalPrice-c.totalDiscountedPrice))+",00 ₽ ",1)])])])):Object(r["g"])("",!0)],64)}n("4160"),n("159b"),n("d401"),n("25f0"),n("ac1f"),n("5319"),n("13d5"),n("1276"),n("b680");var lt=function(e){return+e.toString().replace(/\D/g,"")},st=function(e){return e.toFixed(0).toString().split("").reduce((function(t,n,r){return t+n+(r!==e.length-1&&r%3===2?" ":"")}),"")},dt={name:"OfferCreateTable",props:{products:{type:Array}},methods:{validateNumberString:st},computed:{totalDiscountedPrice:function(){var e=0;return this.products.forEach((function(t){return e+=lt(t.cost)*lt(t.discount)/100})),e},totalPrice:function(){var e=0;return this.products.forEach((function(t){return e+=lt(t.cost)})),e.toString()}},emits:["removeProduct","editProduct"]};n("6c47");const ft=he()(dt,[["render",ut],["__scopeId","data-v-e3832e78"]]);var bt=ft,pt={components:{BaseTextarea:Oe,BaseSelect:je["a"],OfferCreateTable:bt},computed:{offerDate:function(){var e=new Date(this.offer.created_at),t=e.getDate()<10?"0"+e.getDate():e.getDate(),n=e.toLocaleString("ru",{month:"long"}),r=e.getFullYear();return"".concat(t," ").concat(n," ").concat(r)},edit:function(){return!!this.$route.query.id}},data:function(){return{offer:null,data:{counterparty:"",inn:"",address:"",phone:"",email:"",contactPerson:"",validy:"",endCustomer:"",region:"",tech_docs_format:"",tz:!1,ru:!1,tzType:"",ready:""},openModal:!1,modalText:"Отправлено",products:[],productsSearch:"",companies:[{key:"Не Выбран",value:""}],company:"",counterparties:[],productSuggestions:[],currentCounterparty:{},customers:[],currentCustomer:{},currentProduct:""}},setup:function(){Object(ue["b"])({title:"Страница Коммерческого предложения"})},mounted:function(){this.edit&&this.getOffer(),this.getCompanies()},methods:{getCompanies:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/company")).then((function(t){var n,r=Object(ie["a"])(t.data.results);try{var a=function(){var t=n.value,r={key:t.name,value:t.id};!e.companies.some((function(e){return e.value==r.value}))&&r.key&&e.companies.push(r)};for(r.s();!(n=r.n()).done;)a()}catch(o){r.e(o)}finally{r.f()}}))},getOffer:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/offer/").concat(this.$route.query.id)).then((function(t){console.log(t.data),e.offer=t.data,e.currentCounterparty=e.offer.counterparty||"",e.setCounterparty(),e.data.endCustomer=e.offer.end_customer&&e.offer.end_customer.name||"",e.data.region=e.offer.end_customer&&e.offer.end_customer.region||"",e.currentCustomer=e.offer.end_customer,e.products=e.offer.offer_products||"",e.data.company=t.data.company.id||"",e.data.tech_docs_format=e.offer.tech_docs_format}))},getProducts:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=Object(ce["a"])({},this.productsSearch&&"search",this.productsSearch);this.$api.get("".concat(this.$api.defaults.API,"/product"),{params:n}).then((function(n){e.productSuggestions=[];var r,a=Object(ie["a"])(n.data.results);try{for(a.s();!(r=a.n()).done;){var o=r.value;"search"!==t&&e.getProduct(),"search"==t&&e.productsSearch&&e.productSuggestions.push({key:o.name,value:o.id})}}catch(c){a.e(c)}finally{a.f()}}))},getProduct:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/product/").concat(this.productsSearch)).then((function(t){console.log(t.data);var n={product:t.data.id,price:"".concat(t.data.price),discount:e.offer.counterparty.discount,count:1,cost:"".concat(t.data.price)};e.currentProduct=n}))},getCounterparties:function(){var e=this,t=Object(ce["a"])({},this.data.counterparty&&"search",this.data.counterparty);this.counterparties=[],this.$api.get("".concat(this.$api.defaults.API,"/counterparty"),{params:t}).then((function(t){var n,r=Object(ie["a"])(t.data.results);try{var a=function(){var t=n.value,r={key:t.name||"",value:t.id||""};!e.counterparties.some((function(e){return e.value===r.value}))&&r.key&&e.counterparties.push(r)};for(r.s();!(n=r.n()).done;)a()}catch(o){r.e(o)}finally{r.f()}}))},getCounterparty:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/counterparty/").concat(this.data.counterparty)).then((function(t){e.currentCounterparty=t.data,e.setCounterparty()}))},setCounterparty:function(){this.data.counterparty=this.currentCounterparty.name||"",this.data.inn=this.currentCounterparty.inn||"",this.data.address="".concat(this.currentCounterparty.address_street&&this.currentCounterparty.address_street+","," ").concat(this.currentCounterparty.address_city&&this.currentCounterparty.address_city+","," ").concat(this.currentCounterparty.address_country&&this.currentCounterparty.address_country+","," ").concat(this.currentCounterparty.address_index&&this.currentCounterparty.address_index),this.data.phone="+".concat(this.currentCounterparty.phone_number),this.data.email=this.currentCounterparty.email,this.data.contactPerson=this.currentCounterparty.contact_person||""},getEndCustomer:function(){var e=this,t=Object(ce["a"])({},this.data.endCustomer&&"search",this.data.endCustomer);this.customers=[],this.$api.get("".concat(this.$api.defaults.API,"/end-customer"),{params:t}).then((function(t){console.log(t.data);var n,r=Object(ie["a"])(t.data.results);try{var a=function(){var t=n.value,r={key:t.name||"",value:t.id||""};!e.customers.some((function(e){return e.value===r.value}))&&r.key&&e.customers.push(r)};for(r.s();!(n=r.n()).done;)a()}catch(o){r.e(o)}finally{r.f()}}))},setCustomer:function(){var e=this;this.data.endCustomer&&this.$api.get("".concat(this.$api.defaults.API,"/end-customer/").concat(this.data.endCustomer)).then((function(t){e.currentCustomer=t.data,e.data.endCustomer=e.currentCustomer.name||"",e.data.region=e.currentCustomer.region||""}))},addProduct:function(){var e=this;this.$api.post("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/product"),this.currentProduct).then((function(t){console.log(t.data),e.offer.offer_products.push(t.data)}))},editProduct:function(e){var t=this.products.findIndex((function(t){return t.id===e})),n={product:this.products[t].product[t],price:this.products[t].price,discount:this.products[t].discount,count:this.products[t].count,cost:this.products[t].cost};console.log(n),this.$api.patch("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/product/").concat(e),{data:n}).then((function(e){console.log(e.data)}))},removeProduct:function(e){var t=this;this.$api.delete("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/product/").concat(e)).then((function(){var n=t.products.findIndex((function(t){return t.id==e}));t.products.splice(n,1)}))},sendToEmail:function(){var e=this,t={send_to:this.data.email,co_format:this.data.tzType,required_tech_docs:this.data.tz,tech_docs_format:this.data.tech_docs_format,required_ru:this.data.ru};this.$api.post("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id,"/send-to-email"),t).then((function(){e.modalText="Отправлено",e.openModal=!0}))},saveOffer:function(){var e=this,t=[];if(this.edit&&this.offer.offer_products){var n,r=Object(ie["a"])(this.offer.offer_products);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.push({product:a.product,price:a.price,discount:a.discount,count:a.count,cost:a.cost})}}catch(c){r.e(c)}finally{r.f()}}var o={counterparty:this.currentCounterparty.id||null,end_customer:this.currentCustomer.id||null,company:this.data.company||null,offer_products:t||null,tech_docs_format:this.data.tech_docs_format};this.edit?this.$api.patch("".concat(this.$api.defaults.API,"/offer/").concat(this.offer.id),o).then((function(){e.modalText="Сохранено",e.openModal=!0})):this.$api.post("".concat(this.$api.defaults.API,"/offer"),o).then((function(){e.modalText="Сохранено",e.openModal=!0;for(var t=0,n=Object.entries(e.data);t<n.length;t++){var r=Object(oe["a"])(n[t],1),a=r[0];e.data[a]=""}}))}}};n("7b73");const ht=he()(pt,[["render",ae],["__scopeId","data-v-51b12b4c"]]);t["default"]=ht},"723b":function(e,t,n){},"7b73":function(e,t,n){"use strict";n("5f91")},"7db0":function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").find,o=n("44d2"),c="find",i=!0;c in[]&&Array(1)[c]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o(c)},"84f2":function(e,t,n){},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},b680:function(e,t,n){"use strict";var r=n("23e7"),a=n("da84"),o=n("e330"),c=n("5926"),i=n("408a"),u=n("1148"),l=n("d039"),s=a.RangeError,d=a.String,f=Math.floor,b=o(u),p=o("".slice),h=o(1..toFixed),m=function(e,t,n){return 0===t?n:t%2===1?m(e,t-1,n*e):m(e*e,t/2,n)},O=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},j=function(e,t,n){var r=-1,a=n;while(++r<6)a+=t*e[r],e[r]=a%1e7,a=f(a/1e7)},v=function(e,t){var n=6,r=0;while(--n>=0)r+=e[n],e[n]=f(r/t),r=r%t*1e7},y=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var r=d(e[t]);n=""===n?r:n+b("0",7-r.length)+r}return n},g=l((function(){return"0.000"!==h(8e-5,3)||"1"!==h(.9,0)||"1.25"!==h(1.255,2)||"1000000000000000128"!==h(0xde0b6b3a7640080,0)}))||!l((function(){h({})}));r({target:"Number",proto:!0,forced:g},{toFixed:function(e){var t,n,r,a,o=i(this),u=c(e),l=[0,0,0,0,0,0],f="",h="0";if(u<0||u>20)throw s("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return d(o);if(o<0&&(f="-",o=-o),o>1e-21)if(t=O(o*m(2,69,1))-69,n=t<0?o*m(2,-t,1):o/m(2,t,1),n*=4503599627370496,t=52-t,t>0){j(l,0,n),r=u;while(r>=7)j(l,1e7,0),r-=7;j(l,m(10,r,1),0),r=t-1;while(r>=23)v(l,1<<23),r-=23;v(l,1<<r),j(l,1,1),v(l,2),h=y(l)}else j(l,0,n),j(l,1<<-t,0),h=y(l)+b("0",u);return u>0?(a=h.length,h=f+(a<=u?"0."+b("0",u-a)+h:p(h,0,a-u)+"."+p(h,a-u))):h=f+h,h}})},be12:function(e,t,n){"use strict";n("99af");var r=n("7a23"),a={key:0},o={key:1,class:"selected ellipse"},c=["onClick"];function i(e,t,n,i,u,l){var s=Object(r["G"])("click-outside");return Object(r["Q"])((Object(r["x"])(),Object(r["h"])("div",{class:Object(r["s"])(["base-select",{"base-select-border":n.borderOnly}]),ref:"select"},[Object(r["i"])("div",{class:Object(r["s"])(["base-select-selected",[{open:u.open,disabled:n.disabled},{"base-select-selected-border":n.borderOnly,active:n.modelValue&&""!==n.modelValue}]]),onClick:t[0]||(t[0]=function(){return l.openDropdown&&l.openDropdown.apply(l,arguments)})},[!n.modelValue||""==n.modelValue&&n.placeholder?(Object(r["x"])(),Object(r["h"])("span",a,Object(r["J"])(n.placeholder),1)):(Object(r["x"])(),Object(r["h"])("span",o,Object(r["J"])(l.selected&&l.selected.key),1))],2),!n.disabled&&u.open?(Object(r["x"])(),Object(r["h"])("div",{key:0,class:Object(r["s"])(["base-select-items",{"base-select-items-border":n.borderOnly}]),ref:"dropdown",style:Object(r["t"])(u.dropdownDirection)},[(Object(r["x"])(!0),Object(r["h"])(r["b"],null,Object(r["D"])(n.options,(function(t,a){return Object(r["x"])(),Object(r["h"])("div",{key:"".concat(t.value,"_").concat(a),class:Object(r["s"])({active:n.modelValue==t.value}),onClick:function(n){l.selected=t,u.open=!1,e.$emit("update:modelValue",t.value),e.$emit("change")}},Object(r["J"])(t.key),11,c)})),128))],6)):Object(r["g"])("",!0)],2)),[[s,l.closeDropdown]])}n("a9e3"),n("7db0"),n("d3b7");var u={props:{options:{type:Array,required:!0},label:{type:String,default:""},placeholder:{type:[Number,String],default:""},disabled:{type:Boolean},borderOnly:{type:Boolean},modelValue:{type:[String,Number]},yellowBg:{type:Boolean}},computed:{selected:function(){var e=this;return this.options.find((function(t){return t.value===e.modelValue}))||""}},data:function(){return{open:!1,dropdownDirection:null}},methods:{openDropdown:function(){var e=this;this.disabled||(this.open=!this.open),this.open&&setTimeout((function(){var t=e.$refs.select.getBoundingClientRect().top,n=e.$refs.dropdown.getBoundingClientRect().height;window.innerHeight-t<n+60?e.dropdownDirection="top: auto; bottom: ".concat(e.borderOnly?23:40,"px"):e.dropdownDirection="top: ".concat(e.borderOnly?23:40,"px")}))},closeDropdown:function(){this.open=!1}},emits:["update:modelValue","change"]},l=(n("09ca"),n("6b0d")),s=n.n(l);const d=s()(u,[["render",i],["__scopeId","data-v-6d419576"]]);t["a"]=d},f26d:function(e,t,n){"use strict";n("417c")}}]);
//# sourceMappingURL=offerCreate.c6ec75e9.js.map