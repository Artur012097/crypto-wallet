(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["certificate"],{"11cb":function(e,t,c){"use strict";c.r(t);var i=c("7a23"),a={class:"tech-certificate"},l=Object(i["i"])("h1",{class:"tech-certificate__title page__title"}," Регистрационное удостоверение ",-1),n={class:"tech-certificate-wrapper page-wrapper"},s={class:"tech-certificate-header"},r={class:"tech-certificate-header__title"},o=Object(i["j"])(" Поиск"),b={key:0},u=Object(i["j"])(": "),d={class:"tech-certificate-header__buttons"},f={class:"tech-certificate-header__kp"},j=Object(i["j"])(" по "),O=Object(i["i"])("span",{class:"upp",style:{"margin-left":"2px"}},"кп",-1),h={class:"tech-certificate-header__vendor"},p=Object(i["j"])(" по артикулу "),v={class:"tech-certificate-content"},m={class:"tech-certificate-article-field article-row _kp"},g={class:"offer-create-products-field article-row-field"},_={class:"offer-create-products-add article-row-button"},k=Object(i["j"])(" Добавить "),y={class:"tech-certificate-kp"},w={class:"tech-certificate-kp-fields fields"},x={key:0,class:"tech-certificate-fields-row fields-row _number"},C={class:"tech-certificate-fields-row fields-row _email"},A={class:"tech-certificate-buttons page-buttons _save _ru"},$={class:"tech-certificate-buttons__send _save__button"},P=Object(i["j"])("Отправить"),I={class:"tech-certificate-buttons__download"},V=Object(i["j"])("Скачать");function J(e,t,c,J,M,S){var T=Object(i["F"])("base-button"),F=Object(i["F"])("base-input"),R=Object(i["F"])("certificates-table"),D=Object(i["F"])("base-modal");return Object(i["x"])(),Object(i["h"])(i["b"],null,[Object(i["i"])("section",a,[l,Object(i["i"])("div",n,[Object(i["i"])("div",s,[Object(i["i"])("span",r,[o,e.$isMobile?Object(i["g"])("",!0):(Object(i["x"])(),Object(i["h"])("span",b," документа")),u]),Object(i["i"])("div",d,[Object(i["i"])("div",f,[Object(i["k"])(T,{type:"link-button",active:1==M.active,onClicked:t[0]||(t[0]=function(e){return M.active=1})},{default:Object(i["P"])((function(){return[j,O]})),_:1},8,["active"])]),Object(i["i"])("div",h,[Object(i["k"])(T,{type:"link-button",active:2==M.active,onClicked:t[1]||(t[1]=function(e){return M.active=2})},{default:Object(i["P"])((function(){return[p]})),_:1},8,["active"])])])]),Object(i["i"])("div",v,[2==M.active?(Object(i["x"])(),Object(i["h"])("div",{key:0,class:Object(i["s"])(["tech-certificate-article",{filled:M.articles.length}])},[Object(i["i"])("div",m,[Object(i["i"])("div",g,[Object(i["k"])(F,{id:"offerCreateConterparty",placeholder:"Артикул или наименование",search:!0,suggestionWidth:380,addProduct:!0,suggestions:M.articlesSuggestions,onClear:t[2]||(t[2]=function(e){return M.article=""}),onInput:S.getArticles,modelValue:M.article,"onUpdate:modelValue":t[3]||(t[3]=function(e){return M.article=e})},null,8,["suggestions","onInput","modelValue"])]),Object(i["i"])("div",_,[Object(i["k"])(T,{type:"outlined",onClicked:S.addArticle},{default:Object(i["P"])((function(){return[k]})),_:1},8,["onClicked"])])]),Object(i["k"])(R,{articles:M.articles,onRemoveArticle:S.removeArticle},null,8,["articles","onRemoveArticle"])],2)):Object(i["g"])("",!0),Object(i["i"])("div",y,[Object(i["i"])("div",w,[1==M.active?(Object(i["x"])(),Object(i["h"])("div",x,[Object(i["k"])(F,{label:"№ КП",id:"techDocsKp",search:!0,suggestionWidth:380,addProduct:!0,suggestions:M.kpSuggestions,onClear:t[4]||(t[4]=function(e){return M.number="",S.getOffers()}),onInput:S.getOffers,modelValue:M.number,"onUpdate:modelValue":t[5]||(t[5]=function(e){return M.number=e})},null,8,["suggestions","onInput","modelValue"])])):Object(i["g"])("",!0),Object(i["i"])("div",C,[Object(i["k"])(F,{label:"Электронная почта",id:"techEmail",modelValue:M.email,"onUpdate:modelValue":t[6]||(t[6]=function(e){return M.email=e})},null,8,["modelValue"])])])])])]),Object(i["i"])("div",A,[Object(i["i"])("div",$,[Object(i["k"])(T,{type:"filled",onClicked:S.send},{default:Object(i["P"])((function(){return[P]})),_:1},8,["onClicked"])]),Object(i["i"])("div",I,[Object(i["k"])(T,{type:"outlined",onClicked:S.download},{default:Object(i["P"])((function(){return[V]})),_:1},8,["onClicked"])])])]),Object(i["k"])(D,{open:M.openModal,text:M.modalText,onClose:t[7]||(t[7]=function(e){return M.openModal=!1})},null,8,["open","text"])],64)}var M=c("b85c"),S=c("ade3"),T=(c("99af"),c("45fc"),c("d3b7"),c("c740"),c("a434"),c("213a")),F=(c("b0c0"),c("c8de")),R=c.n(F),D={key:0,class:"tech-certificate-article-table"},U=Object(i["i"])("thead",null,[Object(i["i"])("tr",null,[Object(i["i"])("th",null,"Артикул"),Object(i["i"])("th",null,"Наименование"),Object(i["i"])("th")])],-1),q={key:0},Q={class:"tooltip"},W={class:"tooltip"},E={class:"no-wrap"},G=["onClick"],K=Object(i["i"])("img",{src:R.a,alt:"Remove"},null,-1),z=[K],B={key:1,class:"tech-certificate-table-mobile table-mobile",ref:"table"},H=["onClick"],L=Object(i["i"])("img",{src:R.a,alt:"Remove"},null,-1),N=[L],X={class:"table-mobile-row"},Y=Object(i["i"])("span",{class:"table-mobile__title tech-certificate-table-mobile__title"}," Артикул ",-1),Z={class:"table-mobile__value"},ee={class:"table-mobile-row"},te=Object(i["i"])("span",{class:"table-mobile__title tech-certificate-table-mobile__title"}," Наим-ие ",-1),ce={class:"table-mobile__value"};function ie(e,t,c,a,l,n){var s=Object(i["G"])("tooltip");return e.$isMobile?c.articles.length&&e.$isMobile?(Object(i["x"])(),Object(i["h"])("div",B,[(Object(i["x"])(!0),Object(i["h"])(i["b"],null,Object(i["D"])(c.articles,(function(t){return Object(i["x"])(),Object(i["h"])("div",{class:"table-mobile-column",key:t.id},[Object(i["i"])("span",{class:"_remove",onClick:function(){e.$emit("removeArticle",t.id)}},N,8,H),Object(i["i"])("div",X,[Y,Object(i["i"])("span",Z,Object(i["J"])(t.article),1)]),Object(i["i"])("div",ee,[te,Object(i["i"])("span",ce,Object(i["J"])(t.name),1)])])})),128))],512)):Object(i["g"])("",!0):(Object(i["x"])(),Object(i["h"])("table",D,[U,c.articles.length?(Object(i["x"])(),Object(i["h"])("tbody",q,[(Object(i["x"])(!0),Object(i["h"])(i["b"],null,Object(i["D"])(c.articles,(function(t){return Object(i["x"])(),Object(i["h"])("tr",{key:t.id},[Object(i["i"])("td",null,[Object(i["i"])("span",null,Object(i["J"])(t.article),1),Object(i["Q"])((Object(i["x"])(),Object(i["h"])("span",Q,[Object(i["j"])(Object(i["J"])(t.article),1)])),[[s]])]),Object(i["i"])("td",null,[Object(i["i"])("span",null,Object(i["J"])(t.name),1),Object(i["Q"])((Object(i["x"])(),Object(i["h"])("span",W,[Object(i["j"])(Object(i["J"])(t.name),1)])),[[s]])]),Object(i["i"])("td",E,[Object(i["i"])("span",{class:"_remove",onClick:function(){e.$emit("removeArticle",t.id)}},z,8,G)])])})),128))])):Object(i["g"])("",!0)]))}var ae={props:{articles:{type:Array}}},le=c("6b0d"),ne=c.n(le);const se=ne()(ae,[["render",ie]]);var re=se,oe={name:"Certificate",components:{CertificatesTable:re},data:function(){return{active:1,number:"",email:"",article:"",openModal:!1,modalText:"",articles:[],kpSuggestions:[],articlesSuggestions:[]}},setup:function(){Object(T["b"])({title:"Регистрационное удостоверение"})},methods:{getOffers:function(){var e=this;this.kpSuggestions=[];var t=Object(S["a"])({},this.number&&"search",this.number);this.$api.get("".concat(this.$api.defaults.API,"/company"),{params:t}).then((function(t){var c,i=Object(M["a"])(t.data.results);try{for(i.s();!(c=i.n()).done;){var a=c.value;e.number&&e.kpSuggestions.push({key:a.id,value:a.id})}}catch(l){i.e(l)}finally{i.f()}})).catch((function(e){return console.log(e)}))},getArticles:function(){var e=this;this.articlesSuggestions=[];var t=Object(S["a"])({},this.article&&"search",this.article);this.$api.get("".concat(this.$api.defaults.API,"/product"),{params:t}).then((function(t){var c,i=Object(M["a"])(t.data.results);try{for(i.s();!(c=i.n()).done;){var a=c.value;e.article&&e.articlesSuggestions.push({key:a.id,value:a.id})}}catch(l){i.e(l)}finally{i.f()}})).catch((function(e){return console.log(e)}))},addArticle:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/product/").concat(this.article)).then((function(t){!e.articles.some((function(e){return e.article==t.data.article}))&&e.articles.push(t.data),e.article=""}))},send:function(){var e=this;if(1===this.active){var t={send_to:this.email,co_format:"",required_tech_docs:!1,tech_docs_format:"pdf",required_ru:!0};this.$api.post("".concat(this.$api.defaults.API,"/offer/").concat(this.number,"/send-to-email"),t).then((function(){e.modalText="Отправлено",e.openModal=!0})).catch((function(e){return console.log(e)}))}else{var c,i=[],a=Object(M["a"])(this.articles);try{for(a.s();!(c=a.n()).done;){var l=c.value;i.push(l.id)}}catch(s){a.e(s)}finally{a.f()}var n={send_to:this.email,articles:i};this.$api.post("".concat(this.$api.defaults.API,"/permit-document/send-to-email"),n).then((function(){e.modalText="Отправлено",e.openModal=!0}))}},download:function(){if(1===this.active)console.log(123);else{var e,t=[],c=Object(M["a"])(this.articles);try{for(c.s();!(e=c.n()).done;){var i=e.value;t.push(i.id)}}catch(l){c.e(l)}finally{c.f()}var a={tech_docs_format:"pdf",articles:t};this.$api.post("".concat(this.$api.defaults.API,"/tech-docs/download"),a).then((function(e){window.open(e.data.url,"_blank")}))}},removeArticle:function(e){var t=this.articles.findIndex((function(t){return t.article===e}));this.articles.splice(t,1)}}};const be=ne()(oe,[["render",J]]);t["default"]=be}}]);
//# sourceMappingURL=certificate.529b34e2.js.map