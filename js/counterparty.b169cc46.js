(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["counterparty"],{"07ac":function(e,t,a){var n=a("23e7"),r=a("6f53").values;n({target:"Object",stat:!0},{values:function(e){return r(e)}})},"0a79":function(e,t,a){"use strict";a("27f3")},"27f3":function(e,t,a){},3835:function(e,t,a){"use strict";function n(e){if(Array.isArray(e))return e}a.d(t,"a",(function(){return o}));a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function r(e,t){var a=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,c=[],s=!0,o=!1;try{for(a=a.call(e);!(s=(n=a.next()).done);s=!0)if(c.push(n.value),t&&c.length===t)break}catch(l){o=!0,r=l}finally{try{s||null==a["return"]||a["return"]()}finally{if(o)throw r}}return c}}var c=a("06c5");a("d9e2"),a("d401");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){return n(e)||r(e,t)||Object(c["a"])(e,t)||s()}},"4fad":function(e,t,a){var n=a("23e7"),r=a("6f53").entries;n({target:"Object",stat:!0},{entries:function(e){return r(e)}})},5493:function(e,t,a){},"6f53":function(e,t,a){var n=a("83ab"),r=a("e330"),c=a("df75"),s=a("fc6a"),o=a("d1e7").f,l=r(o),i=r([].push),u=function(e){return function(t){var a,r=s(t),o=c(r),u=o.length,d=0,b=[];while(u>d)a=o[d++],n&&!l(r,a)||i(b,e?[a,r[a]]:r[a]);return b}};e.exports={entries:u(!0),values:u(!1)}},"7db0":function(e,t,a){"use strict";var n=a("23e7"),r=a("b727").find,c=a("44d2"),s="find",o=!0;s in[]&&Array(1)[s]((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),c(s)},"9eed":function(e,t,a){"use strict";a("5493")},f546:function(e,t,a){"use strict";a.r(t);a("b0c0");var n=a("7a23"),r=function(e){return Object(n["w"])("data-v-1d3176d8"),e=e(),Object(n["u"])(),e},c={class:"counterparty"},s=r((function(){return Object(n["g"])("h1",{class:"counterparty__title page__title"},"Контрагент",-1)})),o={key:0,class:"counterparty-content page-wrapper"},l={class:"counterparty-fields"},i={class:"counterparty-fields-row fields-row"},u={class:"counterparty-fields-row fields-row _inn"},d={class:"counterparty-fields-row fields-row _address"},b={class:"counterparty-fields-row fields-row"},p={class:"counterparty-fields-row fields-row"},j={class:"counterparty-fields-row fields-row _index"},O={class:"counterparty-fields-row fields-row"},f={class:"counterparty-fields-row fields-row"},g={class:"counterparty-fields-row fields-row _contact-person"},y={class:"counterparty-fields-row fields-row"},m={key:1,class:"counterparty-buttons page-buttons _save"},_={class:"counterparty__send _save__button"},h=Object(n["h"])(" Сохранить "),v={class:"counterparty-search page-wrapper"},w={class:"counterparty-search-field"},V={class:"page-wrapper"};function F(e,t,a,r,F,C){var k=Object(n["B"])("base-input"),q=Object(n["B"])("base-button"),M=Object(n["B"])("counterparty-table"),x=Object(n["B"])("base-modal");return Object(n["t"])(),Object(n["f"])(n["a"],null,[Object(n["g"])("section",c,[s,C.user?(Object(n["t"])(),Object(n["f"])("div",o,[Object(n["g"])("div",l,[Object(n["g"])("div",i,[Object(n["i"])(k,{label:"Контрагент",id:"counterparty",required:!0,modelValue:F.data.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return F.data.name=e})},null,8,["modelValue"])]),Object(n["g"])("div",u,[Object(n["i"])(k,{label:"ИНН",type:"number",id:"counterpartyInn",message:F.message,onInput:t[1]||(t[1]=function(e){return F.message=""}),required:!0,modelValue:F.data.inn,"onUpdate:modelValue":t[2]||(t[2]=function(e){return F.data.inn=e})},null,8,["message","modelValue"])]),Object(n["g"])("div",d,[Object(n["i"])(k,{label:"Адрес",id:"counterpartyAddress",required:!0,modelValue:F.data.address_street,"onUpdate:modelValue":t[3]||(t[3]=function(e){return F.data.address_street=e})},null,8,["modelValue"])]),Object(n["g"])("div",b,[Object(n["i"])(k,{label:"Город",id:"counterpartyCity",required:!0,modelValue:F.data.address_city,"onUpdate:modelValue":t[4]||(t[4]=function(e){return F.data.address_city=e})},null,8,["modelValue"])]),Object(n["g"])("div",p,[Object(n["i"])(k,{label:"Страна",id:"counterpartyCountry",required:!0,modelValue:F.data.address_country,"onUpdate:modelValue":t[5]||(t[5]=function(e){return F.data.address_country=e})},null,8,["modelValue"])]),Object(n["g"])("div",j,[Object(n["i"])(k,{label:"Индекс",type:"number",short:!0,id:"counterpartyCountry",required:!0,modelValue:F.data.address_index,"onUpdate:modelValue":t[6]||(t[6]=function(e){return F.data.address_index=e})},null,8,["modelValue"])]),Object(n["g"])("div",O,[Object(n["i"])(k,{label:"Телефон",type:"number",id:"counterpartyPhone",required:!0,modelValue:F.data.phone_number,"onUpdate:modelValue":t[7]||(t[7]=function(e){return F.data.phone_number=e})},null,8,["modelValue"])]),Object(n["g"])("div",f,[Object(n["i"])(k,{label:"Электронная почта",type:"email",id:"counterpartyEmail",required:!0,modelValue:F.data.email,"onUpdate:modelValue":t[8]||(t[8]=function(e){return F.data.email=e})},null,8,["modelValue"])]),Object(n["g"])("div",g,[Object(n["i"])(k,{label:"Контактное лицо",id:"counterpartyContactPerson",required:!0,modelValue:F.data.contact_person,"onUpdate:modelValue":t[9]||(t[9]=function(e){return F.data.contact_person=e})},null,8,["modelValue"])]),Object(n["g"])("div",y,[Object(n["i"])(k,{label:"Скидка",type:"number",short:!0,id:"counterpartyDiscount",required:!0,modelValue:F.data.discount,"onUpdate:modelValue":t[10]||(t[10]=function(e){return F.data.discount=e})},null,8,["modelValue"])])])])):Object(n["e"])("",!0),C.user?(Object(n["t"])(),Object(n["f"])("div",m,[Object(n["g"])("div",_,[Object(n["i"])(q,{type:"filled",onClick:C.addCounterparty},{default:Object(n["L"])((function(){return[h]})),_:1},8,["onClick"])])])):Object(n["e"])("",!0),Object(n["g"])("div",v,[Object(n["g"])("div",w,[Object(n["i"])(k,{id:"counterpartySearch",placeholder:e.$isMobile?"Поиск":"Поиск по контрагенту или ИНН",search:!0,searchIcon:!0,suggestionWidth:380,suggestions:F.suggestions,onSetSuggestion:C.getCounterparties,onKeypressEnter:C.getCounterparties,onClear:t[11]||(t[11]=function(e){return F.query="",C.getCounterparties()}),onInput:t[12]||(t[12]=function(e){return C.getCounterparties("search")}),modelValue:F.query,"onUpdate:modelValue":t[13]||(t[13]=function(e){return F.query=e})},null,8,["placeholder","suggestions","onSetSuggestion","onKeypressEnter","modelValue"])])]),Object(n["g"])("div",V,[Object(n["i"])(M,{counterparties:F.counterparties,onEdit:C.editCounterparty},null,8,["counterparties","onEdit"])])]),Object(n["i"])(x,{open:F.openModal,text:"Сохранено",onClose:t[14]||(t[14]=function(e){return F.openModal=!1})},null,8,["open"])],64)}var C=a("3835"),k=a("b85c"),q=a("ade3"),M=(a("45fc"),a("d3b7"),a("07ac"),a("99af"),a("c740"),a("4fad"),a("d9e2"),a("d401"),a("7db0"),a("2141")),x=a("30a8"),I=a("4829"),$=function(e){return Object(n["w"])("data-v-02e5d24c"),e=e(),Object(n["u"])(),e},U={key:0,class:"counterparty-table"},A=$((function(){return Object(n["g"])("thead",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",null,"Контрагент"),Object(n["g"])("th",{class:"upp"},"Инн"),Object(n["g"])("th",null,"Адрес"),Object(n["g"])("th",null,"Телефон"),Object(n["g"])("th",null,"Эл. почта"),Object(n["g"])("th",null,"Контактное лицо"),Object(n["g"])("th",null,"Скидка")])],-1)})),B={key:0},S=["onClick"],E={class:"tooltip"},P={class:"tooltip"},T={class:"tooltip"},z={class:"tooltip"},J={class:"tooltip"},K={class:"tooltip"},D={class:"no-wrap"},L={class:"tooltip"},W={key:1,class:"counterparty-table-mobile table-mobile",ref:"table"},G=["onClick"],H={class:"table-mobile-row"},N=$((function(){return Object(n["g"])("span",{class:"table-mobile__title"}," Контрагент ",-1)})),Q={class:"table-mobile__value"},R={class:"table-mobile-row"},X=$((function(){return Object(n["g"])("span",{class:"table-mobile__title upp"}," Инн ",-1)})),Y={class:"table-mobile__value"},Z={class:"table-mobile-row"},ee=$((function(){return Object(n["g"])("span",{class:"table-mobile__title"}," Адрес ",-1)})),te={class:"table-mobile__value"},ae={class:"table-mobile-row"},ne=$((function(){return Object(n["g"])("span",{class:"table-mobile__title"}," Телефон ",-1)})),re={class:"table-mobile__value"},ce={class:"table-mobile-row"},se=$((function(){return Object(n["g"])("span",{class:"table-mobile__title"}," Эл. почта ",-1)})),oe={class:"table-mobile__value"},le={class:"table-mobile-row"},ie=$((function(){return Object(n["g"])("span",{class:"table-mobile__title"}," Конт. лицо ",-1)})),ue={class:"table-mobile__value"},de={class:"table-mobile-row"},be=$((function(){return Object(n["g"])("span",{class:"table-mobile__title"}," Скидка ",-1)})),pe={class:"table-mobile__value"};function je(e,t,a,r,c,s){var o=Object(n["C"])("tooltip");return e.$isMobile?a.counterparties.length&&e.$isMobile?(Object(n["t"])(),Object(n["f"])("div",W,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(a.counterparties,(function(t){return Object(n["t"])(),Object(n["f"])("div",{class:"table-mobile-column",key:t.id,onClick:function(a){return e.$emit("edit",t.id)}},[Object(n["g"])("div",H,[N,Object(n["g"])("span",Q,Object(n["F"])(t.name),1)]),Object(n["g"])("div",R,[X,Object(n["g"])("span",Y,Object(n["F"])(t.inn),1)]),Object(n["g"])("div",Z,[ee,Object(n["g"])("span",te,Object(n["F"])(t.address_street&&t.address_street+",")+" "+Object(n["F"])(t.address_city&&t.address_city+",")+" "+Object(n["F"])(t.address_country&&t.address_country+",")+" "+Object(n["F"])(t.address_index&&t.address_index),1)]),Object(n["g"])("div",ae,[ne,Object(n["g"])("span",re," +"+Object(n["F"])(t.phone_number),1)]),Object(n["g"])("div",ce,[se,Object(n["g"])("span",oe,Object(n["F"])(t.email),1)]),Object(n["g"])("div",le,[ie,Object(n["g"])("span",ue,Object(n["F"])(t.contact_person),1)]),Object(n["g"])("div",de,[be,Object(n["g"])("span",pe,Object(n["F"])(t.discount)+"% ",1)])],8,G)})),128))],512)):Object(n["e"])("",!0):(Object(n["t"])(),Object(n["f"])("table",U,[A,a.counterparties.length?(Object(n["t"])(),Object(n["f"])("tbody",B,[(Object(n["t"])(!0),Object(n["f"])(n["a"],null,Object(n["z"])(a.counterparties,(function(t){return Object(n["t"])(),Object(n["f"])("tr",{key:t.id,onClick:function(a){return e.$emit("edit",t.id)}},[Object(n["g"])("td",null,[Object(n["g"])("span",null,Object(n["F"])(t.name),1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",E,[Object(n["h"])(Object(n["F"])(t.name),1)])),[[o]])]),Object(n["g"])("td",null,[Object(n["g"])("span",null,Object(n["F"])(t.inn),1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",P,[Object(n["h"])(Object(n["F"])(t.inn),1)])),[[o]])]),Object(n["g"])("td",null,[Object(n["g"])("span",null,Object(n["F"])(t.address_street&&t.address_street+",")+" "+Object(n["F"])(t.address_city&&t.address_city+",")+" "+Object(n["F"])(t.address_country&&t.address_country+",")+" "+Object(n["F"])(t.address_index&&t.address_index),1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",T,[Object(n["h"])(Object(n["F"])(t.address_street&&t.address_street+",")+" "+Object(n["F"])(t.address_city&&t.address_city+",")+" "+Object(n["F"])(t.address_country&&t.address_country+",")+" "+Object(n["F"])(t.address_index&&t.address_index),1)])),[[o]])]),Object(n["g"])("td",null,[Object(n["g"])("span",null," +"+Object(n["F"])(t.phone_number),1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",z,[Object(n["h"])(" +"+Object(n["F"])(t.phone_number),1)])),[[o]])]),Object(n["g"])("td",null,[Object(n["g"])("span",null,Object(n["F"])(t.email),1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",J,[Object(n["h"])(Object(n["F"])(t.email),1)])),[[o]])]),Object(n["g"])("td",null,[Object(n["g"])("span",null,Object(n["F"])(t.contact_person),1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",K,[Object(n["h"])(Object(n["F"])(t.contact_person),1)])),[[o]])]),Object(n["g"])("td",D,[Object(n["h"])(Object(n["F"])(t.discount)+"% ",1),Object(n["M"])((Object(n["t"])(),Object(n["f"])("span",L,[Object(n["h"])(Object(n["F"])(t.discount)+"% ",1)])),[[o]])])],8,S)})),128))])):Object(n["e"])("",!0)]))}var Oe={name:"CounterpartyTable",props:{counterparties:{type:Array}}},fe=(a("0a79"),a("6b0d")),ge=a.n(fe);const ye=ge()(Oe,[["render",je],["__scopeId","data-v-02e5d24c"]]);var me=ye,_e={name:"Counterparty",components:{BaseInput:M["a"],BaseButton:x["a"],BaseModal:I["a"],CounterpartyTable:me},computed:{user:function(){return this.$store.state.user}},data:function(){return{data:{name:"",inn:"",address_street:"",address_city:"",address_country:"",address_index:"",phone_number:"",email:"",contact_person:"",discount:""},message:"",query:"",openModal:!1,edit:!1,id:"",counterparties:[],suggestions:[]}},mounted:function(){this.getCounterparties()},methods:{getCounterparties:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=Object(q["a"])({},this.query&&"search",this.query);this.suggestions=[],this.$api.get("".concat(this.$api.defaults.API,"/counterparty"),{params:a}).then((function(a){console.log(a.data.results),"search"!==t&&(e.counterparties=[]);var n,r=Object(k["a"])(a.data.results);try{for(r.s();!(n=r.n()).done;){var c=n.value;"search"!==t&&e.counterparties.push(c),"search"==t&&e.query&&e.suggestions.push({key:c.id,value:c.id})}}catch(s){r.e(s)}finally{r.f()}}))},addCounterparty:function(){var e=this;Object.values(this.data).some((function(e){return!e}))||(this.edit?this.$api.patch("".concat(this.$api.defaults.API,"/counterparty/").concat(this.id),this.data).then((function(t){var a=e.counterparties.findIndex((function(e){return e.id==t.data.id}));e.counterparties[a]=t.data;for(var n=0,r=Object.entries(e.data);n<r.length;n++){var c=Object(C["a"])(r[n],1),s=c[0];e.data[s]=""}e.edit=!1,e.openModal=!0})).catch((function(e){new Error(e)})):this.$api.post("".concat(this.$api.defaults.API,"/counterparty"),this.data).then((function(t){e.counterparties.push(t.data);for(var a=0,n=Object.entries(e.data);a<n.length;a++){var r=Object(C["a"])(n[a],1),c=r[0];e.data[c]=""}e.openModal=!0})).catch((function(t){t.response.data.inn&&(e.message="Данный ИНН уже существует в нашей базе данных")})))},editCounterparty:function(e){var t=this.counterparties.find((function(t){return t.id===e}));this.id=t.id,this.edit=!0;for(var a=0,n=Object.entries(t);a<n.length;a++){var r=Object(C["a"])(n[a],1),c=r[0];this.data[c]=t[c]}}}};a("9eed");const he=ge()(_e,[["render",F],["__scopeId","data-v-1d3176d8"]]);t["default"]=he}}]);
//# sourceMappingURL=counterparty.b169cc46.js.map