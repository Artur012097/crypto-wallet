(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["certificate"],{"11cb":function(e,t,c){"use strict";c.r(t);var i=c("7a23"),a={class:"tech-certificate"},l=Object(i["g"])("h1",{class:"tech-certificate__title page__title"}," Регистрационное удостоверение ",-1),n={class:"tech-certificate-wrapper page-wrapper"},s={class:"tech-certificate-header"},r={class:"tech-certificate-header__title"},o=Object(i["h"])(" Поиск"),b={key:0},u=Object(i["h"])(": "),d={class:"tech-certificate-header__buttons"},f={class:"tech-certificate-header__kp"},O=Object(i["h"])(" по "),h=Object(i["g"])("span",{class:"upp",style:{"margin-left":"2px"}},"кп",-1),j={class:"tech-certificate-header__vendor"},p=Object(i["h"])(" по артикулу "),g={class:"tech-certificate-content"},v={class:"tech-certificate-article-field article-row _kp"},m={class:"offer-create-products-field article-row-field"},_={class:"offer-create-products-add article-row-button"},k=Object(i["h"])(" Добавить "),y={class:"tech-certificate-kp"},w={class:"tech-certificate-kp-fields fields"},C={key:0,class:"tech-certificate-fields-row fields-row _number"},A={class:"tech-certificate-fields-row fields-row _email"},$={class:"tech-certificate-buttons page-buttons _save _ru"},M={class:"tech-certificate-buttons__send _save__button"},I=Object(i["h"])("Отправить"),x={class:"tech-certificate-buttons__download"},V=Object(i["h"])("Скачать");function B(e,t,c,B,P,S){var F=Object(i["B"])("base-button"),T=Object(i["B"])("base-input"),L=Object(i["B"])("certificates-table"),R=Object(i["B"])("base-modal");return Object(i["t"])(),Object(i["f"])(i["a"],null,[Object(i["g"])("section",a,[l,Object(i["g"])("div",n,[Object(i["g"])("div",s,[Object(i["g"])("h5",r,[o,e.$isMobile?Object(i["e"])("",!0):(Object(i["t"])(),Object(i["f"])("span",b," документа")),u]),Object(i["g"])("div",d,[Object(i["g"])("div",f,[Object(i["i"])(F,{type:"link-button",active:1==P.active,onClicked:t[0]||(t[0]=function(e){return P.active=1})},{default:Object(i["L"])((function(){return[O,h]})),_:1},8,["active"])]),Object(i["g"])("div",j,[Object(i["i"])(F,{type:"link-button",active:2==P.active,onClicked:t[1]||(t[1]=function(e){return P.active=2})},{default:Object(i["L"])((function(){return[p]})),_:1},8,["active"])])])]),Object(i["g"])("div",g,[2==P.active?(Object(i["t"])(),Object(i["f"])("div",{key:0,class:Object(i["o"])(["tech-certificate-article",{filled:P.articles.length}])},[Object(i["g"])("div",v,[Object(i["g"])("div",m,[Object(i["i"])(T,{id:"offerCreateConterparty",placeholder:"Артикул или наименование",search:!0,suggestionWidth:380,addProduct:!0,suggestions:P.articlesSuggestions,onClear:t[2]||(t[2]=function(e){return P.article=""}),onInput:S.getArticles,modelValue:P.article,"onUpdate:modelValue":t[3]||(t[3]=function(e){return P.article=e})},null,8,["suggestions","onInput","modelValue"])]),Object(i["g"])("div",_,[Object(i["i"])(F,{type:"outlined",onClicked:S.addArticle},{default:Object(i["L"])((function(){return[k]})),_:1},8,["onClicked"])])]),Object(i["i"])(L,{articles:P.articles,onRemoveArticle:S.removeArticle},null,8,["articles","onRemoveArticle"])],2)):Object(i["e"])("",!0),Object(i["g"])("div",y,[Object(i["g"])("div",w,[1==P.active?(Object(i["t"])(),Object(i["f"])("div",C,[Object(i["i"])(T,{label:"№ КП",id:"techDocsKp",search:!0,suggestionWidth:380,addProduct:!0,suggestions:P.kpSuggestions,onClear:t[4]||(t[4]=function(e){return P.number="",S.getOffers()}),onInput:S.getOffers,modelValue:P.number,"onUpdate:modelValue":t[5]||(t[5]=function(e){return P.number=e})},null,8,["suggestions","onInput","modelValue"])])):Object(i["e"])("",!0),Object(i["g"])("div",A,[Object(i["i"])(T,{label:"Электронная почта",id:"techEmail",modelValue:P.email,"onUpdate:modelValue":t[6]||(t[6]=function(e){return P.email=e})},null,8,["modelValue"])])])])])]),Object(i["g"])("div",$,[Object(i["g"])("div",M,[Object(i["i"])(F,{type:"filled",onClicked:S.send},{default:Object(i["L"])((function(){return[I]})),_:1},8,["onClicked"])]),Object(i["g"])("div",x,[Object(i["i"])(F,{type:"outlined",onClicked:S.download},{default:Object(i["L"])((function(){return[V]})),_:1},8,["onClicked"])])])]),Object(i["i"])(R,{open:P.openModal,text:P.modalText,onClose:t[7]||(t[7]=function(e){return P.openModal=!1})},null,8,["open","text"])],64)}var P=c("b85c"),S=c("ade3"),F=(c("99af"),c("45fc"),c("d3b7"),c("c740"),c("a434"),c("30a8")),T=c("2141"),L=c("4829"),R=(c("b0c0"),c("c8de")),U=c.n(R),q={key:0,class:"tech-certificate-article-table"},z=Object(i["g"])("thead",null,[Object(i["g"])("tr",null,[Object(i["g"])("th",null,"Артикул"),Object(i["g"])("th",null,"Наименование"),Object(i["g"])("th")])],-1),E={key:0},J={class:"tooltip"},W={class:"tooltip"},D={class:"no-wrap"},K=["onClick"],G=Object(i["g"])("img",{src:U.a,alt:"Remove"},null,-1),H=[G],N={key:1,class:"tech-certificate-table-mobile table-mobile",ref:"table"},Q=["onClick"],X=Object(i["g"])("img",{src:U.a,alt:"Remove"},null,-1),Y=[X],Z={class:"table-mobile-row"},ee=Object(i["g"])("span",{class:"table-mobile__title tech-certificate-table-mobile__title"}," Артикул ",-1),te={class:"table-mobile__value"},ce={class:"table-mobile-row"},ie=Object(i["g"])("span",{class:"table-mobile__title tech-certificate-table-mobile__title"}," Наим-ие ",-1),ae={class:"table-mobile__value"};function le(e,t,c,a,l,n){var s=Object(i["C"])("tooltip");return e.$isMobile?c.articles.length&&e.$isMobile?(Object(i["t"])(),Object(i["f"])("div",N,[(Object(i["t"])(!0),Object(i["f"])(i["a"],null,Object(i["z"])(c.articles,(function(t){return Object(i["t"])(),Object(i["f"])("div",{class:"table-mobile-column",key:t.id},[Object(i["g"])("span",{class:"_remove",onClick:function(){e.$emit("removeArticle",t.id)}},Y,8,Q),Object(i["g"])("div",Z,[ee,Object(i["g"])("span",te,Object(i["F"])(t.article),1)]),Object(i["g"])("div",ce,[ie,Object(i["g"])("span",ae,Object(i["F"])(t.name),1)])])})),128))],512)):Object(i["e"])("",!0):(Object(i["t"])(),Object(i["f"])("table",q,[z,c.articles.length?(Object(i["t"])(),Object(i["f"])("tbody",E,[(Object(i["t"])(!0),Object(i["f"])(i["a"],null,Object(i["z"])(c.articles,(function(t){return Object(i["t"])(),Object(i["f"])("tr",{key:t.id},[Object(i["g"])("td",null,[Object(i["g"])("span",null,Object(i["F"])(t.article),1),Object(i["M"])((Object(i["t"])(),Object(i["f"])("span",J,[Object(i["h"])(Object(i["F"])(t.article),1)])),[[s]])]),Object(i["g"])("td",null,[Object(i["g"])("span",null,Object(i["F"])(t.name),1),Object(i["M"])((Object(i["t"])(),Object(i["f"])("span",W,[Object(i["h"])(Object(i["F"])(t.name),1)])),[[s]])]),Object(i["g"])("td",D,[Object(i["g"])("span",{class:"_remove",onClick:function(){e.$emit("removeArticle",t.id)}},H,8,K)])])})),128))])):Object(i["e"])("",!0)]))}var ne={props:{articles:{type:Array}}},se=c("6b0d"),re=c.n(se);const oe=re()(ne,[["render",le]]);var be=oe,ue={name:"Certificate",components:{BaseButton:F["a"],BaseInput:T["a"],BaseModal:L["a"],CertificatesTable:be},data:function(){return{active:1,number:"",email:"",article:"",openModal:!1,modalText:"",articles:[],kpSuggestions:[],articlesSuggestions:[]}},methods:{getOffers:function(){var e=this;this.kpSuggestions=[];var t=Object(S["a"])({},this.number&&"search",this.number);this.$api.get("".concat(this.$api.defaults.API,"/company"),{params:t}).then((function(t){var c,i=Object(P["a"])(t.data.results);try{for(i.s();!(c=i.n()).done;){var a=c.value;e.number&&e.kpSuggestions.push({key:a.id,value:a.id})}}catch(l){i.e(l)}finally{i.f()}})).catch((function(e){return console.log(e)}))},getArticles:function(){var e=this;this.articlesSuggestions=[];var t=Object(S["a"])({},this.article&&"search",this.article);this.$api.get("".concat(this.$api.defaults.API,"/product"),{params:t}).then((function(t){var c,i=Object(P["a"])(t.data.results);try{for(i.s();!(c=i.n()).done;){var a=c.value;e.article&&e.articlesSuggestions.push({key:a.id,value:a.id})}}catch(l){i.e(l)}finally{i.f()}})).catch((function(e){return console.log(e)}))},addArticle:function(){var e=this;this.$api.get("".concat(this.$api.defaults.API,"/product/").concat(this.article)).then((function(t){!e.articles.some((function(e){return e.article==t.data.article}))&&e.articles.push(t.data),e.article=""}))},send:function(){var e=this;if(1===this.active){var t={send_to:this.email,co_format:"",required_tech_docs:!1,tech_docs_format:"pdf",required_ru:!0};this.$api.post("".concat(this.$api.defaults.API,"/offer/").concat(this.number,"/send-to-email"),t).then((function(){e.modalText="Отправлено",e.openModal=!0})).catch((function(e){return console.log(e)}))}else{var c,i=[],a=Object(P["a"])(this.articles);try{for(a.s();!(c=a.n()).done;){var l=c.value;i.push(l.id)}}catch(s){a.e(s)}finally{a.f()}var n={send_to:this.email,articles:i};this.$api.post("".concat(this.$api.defaults.API,"/permit-document/send-to-email"),n).then((function(){e.modalText="Отправлено",e.openModal=!0}))}},download:function(){if(1===this.active)console.log(123);else{var e,t=[],c=Object(P["a"])(this.articles);try{for(c.s();!(e=c.n()).done;){var i=e.value;t.push(i.id)}}catch(l){c.e(l)}finally{c.f()}var a={tech_docs_format:"pdf",articles:t};this.$api.post("".concat(this.$api.defaults.API,"/tech-docs/download"),a).then((function(e){window.open(e.data.url,"_blank")}))}},removeArticle:function(e){var t=this.articles.findIndex((function(t){return t.article===e}));this.articles.splice(t,1)}}};const de=re()(ue,[["render",B]]);t["default"]=de},a434:function(e,t,c){"use strict";var i=c("23e7"),a=c("da84"),l=c("23cb"),n=c("5926"),s=c("07fa"),r=c("7b0b"),o=c("65f0"),b=c("8418"),u=c("1dde"),d=u("splice"),f=a.TypeError,O=Math.max,h=Math.min,j=9007199254740991,p="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var c,i,a,u,d,g,v=r(this),m=s(v),_=l(e,m),k=arguments.length;if(0===k?c=i=0:1===k?(c=0,i=m-_):(c=k-2,i=h(O(n(t),0),m-_)),m+c-i>j)throw f(p);for(a=o(v,i),u=0;u<i;u++)d=_+u,d in v&&b(a,u,v[d]);if(a.length=i,c<i){for(u=_;u<m-i;u++)d=u+i,g=u+c,d in v?v[g]=v[d]:delete v[g];for(u=m;u>m-i+c;u--)delete v[u-1]}else if(c>i)for(u=m-i;u>_;u--)d=u+i-1,g=u+c-1,d in v?v[g]=v[d]:delete v[g];for(u=0;u<c;u++)v[u+_]=arguments[u+2];return v.length=m-i+c,a}})}}]);
//# sourceMappingURL=certificate.b2b44a37.js.map