(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["counterparty"],{"07ac":function(e,t,a){var n=a("23e7"),c=a("6f53").values;n({target:"Object",stat:!0},{values:function(e){return c(e)}})},"0a79":function(e,t,a){"use strict";a("27f3")},"27f3":function(e,t,a){},"4fadc":function(e,t,a){var n=a("23e7"),c=a("6f53").entries;n({target:"Object",stat:!0},{entries:function(e){return c(e)}})},"6f53":function(e,t,a){var n=a("83ab"),c=a("e330"),r=a("df75"),s=a("fc6a"),i=a("d1e7").f,o=c(i),l=c([].push),u=function(e){return function(t){var a,c=s(t),i=r(c),u=i.length,d=0,b=[];while(u>d)a=i[d++],n&&!o(c,a)||l(b,e?[a,c[a]]:c[a]);return b}};e.exports={entries:u(!0),values:u(!1)}},"72bc":function(e,t,a){"use strict";a("be93")},"7db0":function(e,t,a){"use strict";var n=a("23e7"),c=a("b727").find,r=a("44d2"),s="find",i=!0;s in[]&&Array(1)[s]((function(){i=!1})),n({target:"Array",proto:!0,forced:i},{find:function(e){return c(this,e,arguments.length>1?arguments[1]:void 0)}}),r(s)},be93:function(e,t,a){},f546:function(e,t,a){"use strict";a.r(t);a("b0c0");var n=a("7a23"),c=function(e){return Object(n["A"])("data-v-691e2fb0"),e=e(),Object(n["y"])(),e},r={class:"counterparty"},s=c((function(){return Object(n["i"])("h1",{class:"counterparty__title page__title"},"Контрагент",-1)})),i={key:0,class:"counterparty-content page-wrapper"},o={class:"counterparty-fields"},l={class:"counterparty-fields-row fields-row"},u={class:"counterparty-fields-row fields-row _inn"},d={class:"counterparty-fields-row fields-row _address"},b={class:"counterparty-fields-row fields-row"},j={class:"counterparty-fields-row fields-row"},p={class:"counterparty-fields-row fields-row _index"},O={class:"counterparty-fields-row fields-row"},f={class:"counterparty-fields-row fields-row"},m={class:"counterparty-fields-row fields-row _contact-person"},y={class:"counterparty-fields-row fields-row"},_={key:1,class:"counterparty-buttons page-buttons _save"},h={class:"counterparty__send _save__button"},v=Object(n["j"])(" Сохранить "),g={class:"counterparty-search page-wrapper"},w={class:"counterparty-search-field"},V={class:"page-wrapper"};function J(e,t,a,c,J,x){var k=Object(n["F"])("base-input"),C=Object(n["F"])("base-button"),q=Object(n["F"])("counterparty-table"),$=Object(n["F"])("base-modal");return Object(n["x"])(),Object(n["h"])(n["b"],null,[Object(n["i"])("section",r,[s,x.user?(Object(n["x"])(),Object(n["h"])("div",i,[Object(n["i"])("div",o,[Object(n["i"])("div",l,[Object(n["k"])(k,{label:"Контрагент",id:"counterparty",required:!0,modelValue:J.data.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return J.data.name=e})},null,8,["modelValue"])]),Object(n["i"])("div",u,[Object(n["k"])(k,{label:"ИНН",type:"number",id:"counterpartyInn",message:J.message,onInput:t[1]||(t[1]=function(e){return J.message=""}),required:!0,modelValue:J.data.inn,"onUpdate:modelValue":t[2]||(t[2]=function(e){return J.data.inn=e})},null,8,["message","modelValue"])]),Object(n["i"])("div",d,[Object(n["k"])(k,{label:"Адрес",id:"counterpartyAddress",required:!0,modelValue:J.data.address_street,"onUpdate:modelValue":t[3]||(t[3]=function(e){return J.data.address_street=e})},null,8,["modelValue"])]),Object(n["i"])("div",b,[Object(n["k"])(k,{label:"Город",id:"counterpartyCity",required:!0,modelValue:J.data.address_city,"onUpdate:modelValue":t[4]||(t[4]=function(e){return J.data.address_city=e})},null,8,["modelValue"])]),Object(n["i"])("div",j,[Object(n["k"])(k,{label:"Страна",id:"counterpartyCountry",required:!0,modelValue:J.data.address_country,"onUpdate:modelValue":t[5]||(t[5]=function(e){return J.data.address_country=e})},null,8,["modelValue"])]),Object(n["i"])("div",p,[Object(n["k"])(k,{label:"Индекс",type:"number",short:!0,id:"counterpartyIndex",required:!0,modelValue:J.data.address_index,"onUpdate:modelValue":t[6]||(t[6]=function(e){return J.data.address_index=e})},null,8,["modelValue"])]),Object(n["i"])("div",O,[Object(n["k"])(k,{label:"Телефон",type:"number",id:"counterpartyPhone",required:!0,modelValue:J.data.phone_number,"onUpdate:modelValue":t[7]||(t[7]=function(e){return J.data.phone_number=e})},null,8,["modelValue"])]),Object(n["i"])("div",f,[Object(n["k"])(k,{label:"Электронная почта",type:"email",id:"counterpartyEmail",required:!0,modelValue:J.data.email,"onUpdate:modelValue":t[8]||(t[8]=function(e){return J.data.email=e})},null,8,["modelValue"])]),Object(n["i"])("div",m,[Object(n["k"])(k,{label:"Контактное лицо",id:"counterpartyContactPerson",required:!0,modelValue:J.data.contact_person,"onUpdate:modelValue":t[9]||(t[9]=function(e){return J.data.contact_person=e})},null,8,["modelValue"])]),Object(n["i"])("div",y,[Object(n["k"])(k,{label:"Скидка",type:"number",short:!0,id:"counterpartyDiscount",required:!0,modelValue:J.data.discount,"onUpdate:modelValue":t[10]||(t[10]=function(e){return J.data.discount=e})},null,8,["modelValue"])])])])):Object(n["g"])("",!0),x.user?(Object(n["x"])(),Object(n["h"])("div",_,[Object(n["i"])("div",h,[Object(n["k"])(C,{type:"filled",onClick:x.addCounterparty},{default:Object(n["P"])((function(){return[v]})),_:1},8,["onClick"])])])):Object(n["g"])("",!0),Object(n["i"])("div",g,[Object(n["i"])("div",w,[Object(n["k"])(k,{id:"counterpartySearch",placeholder:e.$isMobile?"Поиск":"Поиск по контрагенту или ИНН",search:!0,searchIcon:!0,suggestionWidth:380,suggestions:J.suggestions,onSetSuggestion:x.getCounterparties,onKeypressEnter:x.getCounterparties,onClear:t[11]||(t[11]=function(e){return J.query="",x.getCounterparties()}),onInput:t[12]||(t[12]=function(e){return x.getCounterparties("search")}),modelValue:J.query,"onUpdate:modelValue":t[13]||(t[13]=function(e){return J.query=e})},null,8,["placeholder","suggestions","onSetSuggestion","onKeypressEnter","modelValue"])])]),Object(n["i"])("div",V,[Object(n["k"])(q,{counterparties:J.counterparties,onEdit:x.editCounterparty},null,8,["counterparties","onEdit"])])]),Object(n["k"])($,{open:J.openModal,text:"Сохранено",onClose:t[14]||(t[14]=function(e){return J.openModal=!1})},null,8,["open"])],64)}var x=a("3835"),k=a("b85c"),C=a("ade3"),q=(a("45fc"),a("d3b7"),a("07ac"),a("99af"),a("c740"),a("4fadc"),a("d9e2"),a("d401"),a("7db0"),a("213a")),$=function(e){return Object(n["A"])("data-v-02e5d24c"),e=e(),Object(n["y"])(),e},I={key:0,class:"counterparty-table"},U=$((function(){return Object(n["i"])("thead",null,[Object(n["i"])("tr",null,[Object(n["i"])("th",null,"Контрагент"),Object(n["i"])("th",{class:"upp"},"Инн"),Object(n["i"])("th",null,"Адрес"),Object(n["i"])("th",null,"Телефон"),Object(n["i"])("th",null,"Эл. почта"),Object(n["i"])("th",null,"Контактное лицо"),Object(n["i"])("th",null,"Скидка")])],-1)})),A={key:0},M=["onClick"],Q={class:"tooltip"},E={class:"tooltip"},P={class:"tooltip"},S={class:"tooltip"},F={class:"tooltip"},D={class:"tooltip"},K={class:"no-wrap"},T={class:"tooltip"},G={key:1,class:"counterparty-table-mobile table-mobile",ref:"table"},W=["onClick"],z={class:"table-mobile-row"},B=$((function(){return Object(n["i"])("span",{class:"table-mobile__title"}," Контрагент ",-1)})),H={class:"table-mobile__value"},L={class:"table-mobile-row"},N=$((function(){return Object(n["i"])("span",{class:"table-mobile__title upp"}," Инн ",-1)})),R={class:"table-mobile__value"},X={class:"table-mobile-row"},Y=$((function(){return Object(n["i"])("span",{class:"table-mobile__title"}," Адрес ",-1)})),Z={class:"table-mobile__value"},ee={class:"table-mobile-row"},te=$((function(){return Object(n["i"])("span",{class:"table-mobile__title"}," Телефон ",-1)})),ae={class:"table-mobile__value"},ne={class:"table-mobile-row"},ce=$((function(){return Object(n["i"])("span",{class:"table-mobile__title"}," Эл. почта ",-1)})),re={class:"table-mobile__value"},se={class:"table-mobile-row"},ie=$((function(){return Object(n["i"])("span",{class:"table-mobile__title"}," Конт. лицо ",-1)})),oe={class:"table-mobile__value"},le={class:"table-mobile-row"},ue=$((function(){return Object(n["i"])("span",{class:"table-mobile__title"}," Скидка ",-1)})),de={class:"table-mobile__value"};function be(e,t,a,c,r,s){var i=Object(n["G"])("tooltip");return e.$isMobile?a.counterparties.length&&e.$isMobile?(Object(n["x"])(),Object(n["h"])("div",G,[(Object(n["x"])(!0),Object(n["h"])(n["b"],null,Object(n["D"])(a.counterparties,(function(t){return Object(n["x"])(),Object(n["h"])("div",{class:"table-mobile-column",key:t.id,onClick:function(a){return e.$emit("edit",t.id)}},[Object(n["i"])("div",z,[B,Object(n["i"])("span",H,Object(n["J"])(t.name),1)]),Object(n["i"])("div",L,[N,Object(n["i"])("span",R,Object(n["J"])(t.inn),1)]),Object(n["i"])("div",X,[Y,Object(n["i"])("span",Z,Object(n["J"])(t.address_street&&t.address_street+",")+" "+Object(n["J"])(t.address_city&&t.address_city+",")+" "+Object(n["J"])(t.address_country&&t.address_country+",")+" "+Object(n["J"])(t.address_index&&t.address_index),1)]),Object(n["i"])("div",ee,[te,Object(n["i"])("span",ae," +"+Object(n["J"])(t.phone_number),1)]),Object(n["i"])("div",ne,[ce,Object(n["i"])("span",re,Object(n["J"])(t.email),1)]),Object(n["i"])("div",se,[ie,Object(n["i"])("span",oe,Object(n["J"])(t.contact_person),1)]),Object(n["i"])("div",le,[ue,Object(n["i"])("span",de,Object(n["J"])(t.discount)+"% ",1)])],8,W)})),128))],512)):Object(n["g"])("",!0):(Object(n["x"])(),Object(n["h"])("table",I,[U,a.counterparties.length?(Object(n["x"])(),Object(n["h"])("tbody",A,[(Object(n["x"])(!0),Object(n["h"])(n["b"],null,Object(n["D"])(a.counterparties,(function(t){return Object(n["x"])(),Object(n["h"])("tr",{key:t.id,onClick:function(a){return e.$emit("edit",t.id)}},[Object(n["i"])("td",null,[Object(n["i"])("span",null,Object(n["J"])(t.name),1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",Q,[Object(n["j"])(Object(n["J"])(t.name),1)])),[[i]])]),Object(n["i"])("td",null,[Object(n["i"])("span",null,Object(n["J"])(t.inn),1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",E,[Object(n["j"])(Object(n["J"])(t.inn),1)])),[[i]])]),Object(n["i"])("td",null,[Object(n["i"])("span",null,Object(n["J"])(t.address_street&&t.address_street+",")+" "+Object(n["J"])(t.address_city&&t.address_city+",")+" "+Object(n["J"])(t.address_country&&t.address_country+",")+" "+Object(n["J"])(t.address_index&&t.address_index),1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",P,[Object(n["j"])(Object(n["J"])(t.address_street&&t.address_street+",")+" "+Object(n["J"])(t.address_city&&t.address_city+",")+" "+Object(n["J"])(t.address_country&&t.address_country+",")+" "+Object(n["J"])(t.address_index&&t.address_index),1)])),[[i]])]),Object(n["i"])("td",null,[Object(n["i"])("span",null," +"+Object(n["J"])(t.phone_number),1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",S,[Object(n["j"])(" +"+Object(n["J"])(t.phone_number),1)])),[[i]])]),Object(n["i"])("td",null,[Object(n["i"])("span",null,Object(n["J"])(t.email),1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",F,[Object(n["j"])(Object(n["J"])(t.email),1)])),[[i]])]),Object(n["i"])("td",null,[Object(n["i"])("span",null,Object(n["J"])(t.contact_person),1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",D,[Object(n["j"])(Object(n["J"])(t.contact_person),1)])),[[i]])]),Object(n["i"])("td",K,[Object(n["j"])(Object(n["J"])(t.discount)+"% ",1),Object(n["Q"])((Object(n["x"])(),Object(n["h"])("span",T,[Object(n["j"])(Object(n["J"])(t.discount)+"% ",1)])),[[i]])])],8,M)})),128))])):Object(n["g"])("",!0)]))}var je={name:"CounterpartyTable",props:{counterparties:{type:Array}}},pe=(a("0a79"),a("6b0d")),Oe=a.n(pe);const fe=Oe()(je,[["render",be],["__scopeId","data-v-02e5d24c"]]);var me=fe,ye={name:"Counterparty",components:{CounterpartyTable:me},computed:{user:function(){return this.$store.state.user}},data:function(){return{data:{name:"",inn:"",address_street:"",address_city:"",address_country:"",address_index:"",phone_number:"",email:"",contact_person:"",discount:""},message:"",query:"",openModal:!1,edit:!1,id:"",counterparties:[],suggestions:[]}},setup:function(){Object(q["b"])({title:"Контрагент"})},mounted:function(){this.getCounterparties()},methods:{getCounterparties:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=Object(C["a"])({},this.query&&"search",this.query);this.suggestions=[],this.$api.get("".concat(this.$api.defaults.API,"/counterparty"),{params:a}).then((function(a){console.log(a.data.results),"search"!==t&&(e.counterparties=[]);var n,c=Object(k["a"])(a.data.results);try{for(c.s();!(n=c.n()).done;){var r=n.value;"search"!==t&&e.counterparties.push(r),"search"==t&&e.query&&e.suggestions.push({key:r.id,value:r.id})}}catch(s){c.e(s)}finally{c.f()}}))},addCounterparty:function(){var e=this;Object.values(this.data).some((function(e){return!e}))||(this.edit?this.$api.patch("".concat(this.$api.defaults.API,"/counterparty/").concat(this.id),this.data).then((function(t){var a=e.counterparties.findIndex((function(e){return e.id==t.data.id}));e.counterparties[a]=t.data;for(var n=0,c=Object.entries(e.data);n<c.length;n++){var r=Object(x["a"])(c[n],1),s=r[0];e.data[s]=""}e.edit=!1,e.openModal=!0})).catch((function(e){new Error(e)})):this.$api.post("".concat(this.$api.defaults.API,"/counterparty"),this.data).then((function(t){e.counterparties.push(t.data);for(var a=0,n=Object.entries(e.data);a<n.length;a++){var c=Object(x["a"])(n[a],1),r=c[0];e.data[r]=""}e.openModal=!0})).catch((function(t){t.response.data.inn&&(e.message="Данный ИНН уже существует в нашей базе данных")})))},editCounterparty:function(e){var t=this.counterparties.find((function(t){return t.id===e}));this.id=t.id,this.edit=!0;for(var a=0,n=Object.entries(t);a<n.length;a++){var c=Object(x["a"])(n[a],1),r=c[0];this.data[r]=t[r]}}}};a("72bc");const _e=Oe()(ye,[["render",J],["__scopeId","data-v-691e2fb0"]]);t["default"]=_e}}]);
//# sourceMappingURL=counterparty.2493b09f.js.map